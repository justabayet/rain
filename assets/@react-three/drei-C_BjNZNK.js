import{a as sn,R as Me,r as f,g as an}from"../react-dom-ZcwTowb8.js";import{c as cn,u as H,a as ke,b as Ee,e as ln,d as un}from"./fiber-DqavkFx2.js";import{j as St,V as D,k as Ot,l as Mt,m as fn,n as hn,o as dn,p as pn,q as mn,E as gn,r as q,s as Q,Q as se,P as fe,O as he,t as ot,c as K,u as yn,v as Re,T as rt,D as X,w as bn,x as Le,C as vn}from"../three-O-IJA8ay.js";var it={},st=sn;it.createRoot=st.createRoot,it.hydrateRoot=st.hydrateRoot;function F(){return F=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var t in o)({}).hasOwnProperty.call(o,t)&&(n[t]=o[t])}return n},F.apply(null,arguments)}function En(n,e,o){return Math.max(e,Math.min(n,o))}const j={toVector(n,e){return n===void 0&&(n=e),Array.isArray(n)?n:[n,n]},add(n,e){return[n[0]+e[0],n[1]+e[1]]},sub(n,e){return[n[0]-e[0],n[1]-e[1]]},addTo(n,e){n[0]+=e[0],n[1]+=e[1]},subTo(n,e){n[0]-=e[0],n[1]-=e[1]}};function at(n,e,o){return e===0||Math.abs(e)===1/0?Math.pow(n,o*5):n*e*o/(e+o*n)}function ct(n,e,o,t=.15){return t===0?En(n,e,o):n<e?-at(e-n,o-e,t)+e:n>o?+at(n-o,o-e,t)+o:n}function _n(n,[e,o],[t,i]){const[[s,h],[a,c]]=n;return[ct(e,s,h,t),ct(o,a,c,i)]}function wn(n,e){if(typeof n!="object"||n===null)return n;var o=n[Symbol.toPrimitive];if(o!==void 0){var t=o.call(n,e||"default");if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Tn(n){var e=wn(n,"string");return typeof e=="symbol"?e:String(e)}function N(n,e,o){return e=Tn(e),e in n?Object.defineProperty(n,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[e]=o,n}function lt(n,e){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),o.push.apply(o,t)}return o}function C(n){for(var e=1;e<arguments.length;e++){var o=arguments[e]!=null?arguments[e]:{};e%2?lt(Object(o),!0).forEach(function(t){N(n,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):lt(Object(o)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(o,t))})}return n}const At={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function ut(n){return n?n[0].toUpperCase()+n.slice(1):""}const Pn=["enter","leave"];function xn(n=!1,e){return n&&!Pn.includes(e)}function Sn(n,e="",o=!1){const t=At[n],i=t&&t[e]||e;return"on"+ut(n)+ut(i)+(xn(o,i)?"Capture":"")}const On=["gotpointercapture","lostpointercapture"];function Mn(n){let e=n.substring(2).toLowerCase();const o=!!~e.indexOf("passive");o&&(e=e.replace("passive",""));const t=On.includes(e)?"capturecapture":"capture",i=!!~e.indexOf(t);return i&&(e=e.replace("capture","")),{device:e,capture:i,passive:o}}function An(n,e=""){const o=At[n],t=o&&o[e]||e;return n+t}function _e(n){return"touches"in n}function Dt(n){return _e(n)?"touch":"pointerType"in n?n.pointerType:"mouse"}function Dn(n){return Array.from(n.touches).filter(e=>{var o,t;return e.target===n.currentTarget||((o=n.currentTarget)===null||o===void 0||(t=o.contains)===null||t===void 0?void 0:t.call(o,e.target))})}function Cn(n){return n.type==="touchend"||n.type==="touchcancel"?n.changedTouches:n.targetTouches}function Ct(n){return _e(n)?Cn(n)[0]:n}function In(n){return Dn(n).map(e=>e.identifier)}function Ae(n){const e=Ct(n);return _e(n)?e.identifier:e.pointerId}function ft(n){const e=Ct(n);return[e.clientX,e.clientY]}function kn(n){const e={};if("buttons"in n&&(e.buttons=n.buttons),"shiftKey"in n){const{shiftKey:o,altKey:t,metaKey:i,ctrlKey:s}=n;Object.assign(e,{shiftKey:o,altKey:t,metaKey:i,ctrlKey:s})}return e}function ve(n,...e){return typeof n=="function"?n(...e):n}function Rn(){}function Ln(...n){return n.length===0?Rn:n.length===1?n[0]:function(){let e;for(const o of n)e=o.apply(this,arguments)||e;return e}}function ht(n,e){return Object.assign({},e,n||{})}const jn=32;class Un{constructor(e,o,t){this.ctrl=e,this.args=o,this.key=t,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:o,ingKey:t,args:i}=this;o[t]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=i,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const o=this.state,t=this.config;o._active||(this.reset(),this.computeInitial(),o._active=!0,o.target=e.target,o.currentTarget=e.currentTarget,o.lastOffset=t.from?ve(t.from,o):o.offset,o.offset=o.lastOffset,o.startTime=o.timeStamp=e.timeStamp)}computeValues(e){const o=this.state;o._values=e,o.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:o,config:t,shared:i}=this;o.args=this.args;let s=0;if(e&&(o.event=e,t.preventDefault&&e.cancelable&&o.event.preventDefault(),o.type=e.type,i.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,i.locked=!!document.pointerLockElement,Object.assign(i,kn(e)),i.down=i.pressed=i.buttons%2===1||i.touches>0,s=e.timeStamp-o.timeStamp,o.timeStamp=e.timeStamp,o.elapsedTime=o.timeStamp-o.startTime),o._active){const m=o._delta.map(Math.abs);j.addTo(o._distance,m)}this.axisIntent&&this.axisIntent(e);const[h,a]=o._movement,[c,p]=t.threshold,{_step:u,values:d}=o;if(t.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(h)>=c&&d[0]),u[1]===!1&&(u[1]=Math.abs(a)>=p&&d[1])):(u[0]===!1&&(u[0]=Math.abs(h)>=c&&Math.sign(h)*c),u[1]===!1&&(u[1]=Math.abs(a)>=p&&Math.sign(a)*p)),o.intentional=u[0]!==!1||u[1]!==!1,!o.intentional)return;const b=[0,0];if(t.hasCustomTransform){const[m,U]=d;b[0]=u[0]!==!1?m-u[0]:0,b[1]=u[1]!==!1?U-u[1]:0}else b[0]=u[0]!==!1?h-u[0]:0,b[1]=u[1]!==!1?a-u[1]:0;this.restrictToAxis&&!o._blocked&&this.restrictToAxis(b);const w=o.offset,T=o._active&&!o._blocked||o.active;T&&(o.first=o._active&&!o.active,o.last=!o._active&&o.active,o.active=i[this.ingKey]=o._active,e&&(o.first&&("bounds"in t&&(o._bounds=ve(t.bounds,o)),this.setup&&this.setup()),o.movement=b,this.computeOffset()));const[P,M]=o.offset,[[x,v],[E,I]]=o._bounds;o.overflow=[P<x?-1:P>v?1:0,M<E?-1:M>I?1:0],o._movementBound[0]=o.overflow[0]?o._movementBound[0]===!1?o._movement[0]:o._movementBound[0]:!1,o._movementBound[1]=o.overflow[1]?o._movementBound[1]===!1?o._movement[1]:o._movementBound[1]:!1;const S=o._active?t.rubberband||[0,0]:[0,0];if(o.offset=_n(o._bounds,o.offset,S),o.delta=j.sub(o.offset,w),this.computeMovement(),T&&(!o.last||s>jn)){o.delta=j.sub(o.offset,w);const m=o.delta.map(Math.abs);j.addTo(o.distance,m),o.direction=o.delta.map(Math.sign),o._direction=o._delta.map(Math.sign),!o.first&&s>0&&(o.velocity=[m[0]/s,m[1]/s],o.timeDelta=s)}}emit(){const e=this.state,o=this.shared,t=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!t.triggerAllEvents)return;const i=this.handler(C(C(C({},o),e),{},{[this.aliasKey]:e.values}));i!==void 0&&(e.memo=i)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function Nn([n,e],o){const t=Math.abs(n),i=Math.abs(e);if(t>i&&t>o)return"x";if(i>t&&i>o)return"y"}class zn extends Un{constructor(...e){super(...e),N(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=j.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=j.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const o=this.state,t=this.config;if(!o.axis&&e){const i=typeof t.axisThreshold=="object"?t.axisThreshold[Dt(e)]:t.axisThreshold;o.axis=Nn(o._movement,i)}o._blocked=(t.lockDirection||!!t.axis)&&!o.axis||!!t.axis&&t.axis!==o.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const Fn=n=>n,dt=.15,It={enabled(n=!0){return n},eventOptions(n,e,o){return C(C({},o.shared.eventOptions),n)},preventDefault(n=!1){return n},triggerAllEvents(n=!1){return n},rubberband(n=0){switch(n){case!0:return[dt,dt];case!1:return[0,0];default:return j.toVector(n)}},from(n){if(typeof n=="function")return n;if(n!=null)return j.toVector(n)},transform(n,e,o){const t=n||o.shared.transform;return this.hasCustomTransform=!!t,t||Fn},threshold(n){return j.toVector(n,0)}},Kn=0,ae=C(C({},It),{},{axis(n,e,{axis:o}){if(this.lockDirection=o==="lock",!this.lockDirection)return o},axisThreshold(n=Kn){return n},bounds(n={}){if(typeof n=="function")return s=>ae.bounds(n(s));if("current"in n)return()=>n.current;if(typeof HTMLElement=="function"&&n instanceof HTMLElement)return n;const{left:e=-1/0,right:o=1/0,top:t=-1/0,bottom:i=1/0}=n;return[[e,o],[t,i]]}}),pt={ArrowRight:(n,e=1)=>[n*e,0],ArrowLeft:(n,e=1)=>[-1*n*e,0],ArrowUp:(n,e=1)=>[0,-1*n*e],ArrowDown:(n,e=1)=>[0,n*e]};class Bn extends zn{constructor(...e){super(...e),N(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const o=e._bounds.getBoundingClientRect(),t=e.currentTarget.getBoundingClientRect(),i={left:o.left-t.left+e.offset[0],right:o.right-t.right+e.offset[0],top:o.top-t.top+e.offset[1],bottom:o.bottom-t.bottom+e.offset[1]};e._bounds=ae.bounds(i)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const o=this.config,t=this.state;if(e.buttons!=null&&(Array.isArray(o.pointerButtons)?!o.pointerButtons.includes(e.buttons):o.pointerButtons!==-1&&o.pointerButtons!==e.buttons))return;const i=this.ctrl.setEventIds(e);o.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(i&&i.size>1&&t._pointerActive)&&(this.start(e),this.setupPointer(e),t._pointerId=Ae(e),t._pointerActive=!0,this.computeValues(ft(e)),this.computeInitial(),o.preventScrollAxis&&Dt(e)!=="mouse"?(t._active=!1,this.setupScrollPrevention(e)):o.delay>0?(this.setupDelayTrigger(e),o.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const o=this.state;o._active=!0,o._preventScroll=!0,o._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const o=this.state,t=this.config;if(!o._pointerActive)return;const i=Ae(e);if(o._pointerId!==void 0&&i!==o._pointerId)return;const s=ft(e);if(document.pointerLockElement===e.target?o._delta=[e.movementX,e.movementY]:(o._delta=j.sub(s,o._values),this.computeValues(s)),j.addTo(o._movement,o._delta),this.compute(e),o._delayed&&o.intentional){this.timeoutStore.remove("dragDelay"),o.active=!1,this.startPointerDrag(e);return}if(t.preventScrollAxis&&!o._preventScroll)if(o.axis)if(o.axis===t.preventScrollAxis||t.preventScrollAxis==="xy"){o._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const o=this.state,t=this.config;if(!o._active||!o._pointerActive)return;const i=Ae(e);if(o._pointerId!==void 0&&i!==o._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[s,h]=o._distance;if(o.tap=s<=t.tapsThreshold&&h<=t.tapsThreshold,o.tap&&t.filterTaps)o._force=!0;else{const[a,c]=o._delta,[p,u]=o._movement,[d,b]=t.swipe.velocity,[w,T]=t.swipe.distance,P=t.swipe.duration;if(o.elapsedTime<P){const M=Math.abs(a/o.timeDelta),x=Math.abs(c/o.timeDelta);M>d&&Math.abs(p)>w&&(o.swipe[0]=Math.sign(a)),x>b&&Math.abs(u)>T&&(o.swipe[1]=Math.sign(c))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const o=this.config,t=o.device;o.pointerLock&&e.currentTarget.requestPointerLock(),o.pointerCapture||(this.eventStore.add(this.sharedConfig.window,t,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,t,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,t,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,Yn(e);const o=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",o),this.eventStore.add(this.sharedConfig.window,"touch","cancel",o),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const o=pt[e.key];if(o){const t=this.state,i=e.shiftKey?10:e.altKey?.1:1;this.start(e),t._delta=o(this.config.keyboardDisplacement,i),t._keyboardActive=!0,j.addTo(t._movement,t._delta),this.compute(e),this.emit()}}keyUp(e){e.key in pt&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const o=this.config.device;e(o,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(o,"change",this.pointerMove.bind(this)),e(o,"end",this.pointerUp.bind(this)),e(o,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function Yn(n){"persist"in n&&typeof n.persist=="function"&&n.persist()}const ce=typeof window<"u"&&window.document&&window.document.createElement;function kt(){return ce&&"ontouchstart"in window}function Vn(){return kt()||ce&&window.navigator.maxTouchPoints>1}function Hn(){return ce&&"onpointerdown"in window}function Wn(){return ce&&"exitPointerLock"in window.document}function Xn(){try{return"constructor"in GestureEvent}catch{return!1}}const z={isBrowser:ce,gesture:Xn(),touch:kt(),touchscreen:Vn(),pointer:Hn(),pointerLock:Wn()},Zn=250,Gn=180,$n=.5,qn=50,Qn=250,Jn=10,mt={mouse:0,touch:0,pen:8},eo=C(C({},ae),{},{device(n,e,{pointer:{touch:o=!1,lock:t=!1,mouse:i=!1}={}}){return this.pointerLock=t&&z.pointerLock,z.touch&&o?"touch":this.pointerLock?"mouse":z.pointer&&!i?"pointer":z.touch?"touch":"mouse"},preventScrollAxis(n,e,{preventScroll:o}){if(this.preventScrollDelay=typeof o=="number"?o:o||o===void 0&&n?Zn:void 0,!(!z.touchscreen||o===!1))return n||(o!==void 0?"y":void 0)},pointerCapture(n,e,{pointer:{capture:o=!0,buttons:t=1,keys:i=!0}={}}){return this.pointerButtons=t,this.keys=i,!this.pointerLock&&this.device==="pointer"&&o},threshold(n,e,{filterTaps:o=!1,tapsThreshold:t=3,axis:i=void 0}){const s=j.toVector(n,o?t:i?1:0);return this.filterTaps=o,this.tapsThreshold=t,s},swipe({velocity:n=$n,distance:e=qn,duration:o=Qn}={}){return{velocity:this.transform(j.toVector(n)),distance:this.transform(j.toVector(e)),duration:o}},delay(n=0){switch(n){case!0:return Gn;case!1:return 0;default:return n}},axisThreshold(n){return n?C(C({},mt),n):mt},keyboardDisplacement(n=Jn){return n}});C(C({},It),{},{device(n,e,{shared:o,pointer:{touch:t=!1}={}}){if(o.target&&!z.touch&&z.gesture)return"gesture";if(z.touch&&t)return"touch";if(z.touchscreen){if(z.pointer)return"pointer";if(z.touch)return"touch"}},bounds(n,e,{scaleBounds:o={},angleBounds:t={}}){const i=h=>{const a=ht(ve(o,h),{min:-1/0,max:1/0});return[a.min,a.max]},s=h=>{const a=ht(ve(t,h),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof o!="function"&&typeof t!="function"?[i(),s()]:h=>[i(h),s(h)]},threshold(n,e,o){return this.lockDirection=o.axis==="lock",j.toVector(n,this.lockDirection?[.1,3]:0)},modifierKey(n){return n===void 0?"ctrlKey":n},pinchOnWheel(n=!0){return n}});C(C({},ae),{},{mouseOnly:(n=!0)=>n});C(C({},ae),{},{mouseOnly:(n=!0)=>n});const Rt=new Map,Ie=new Map;function to(n){Rt.set(n.key,n.engine),Ie.set(n.key,n.resolver)}const no={key:"drag",engine:Bn,resolver:eo};function oo(n,e){if(n==null)return{};var o={},t=Object.keys(n),i,s;for(s=0;s<t.length;s++)i=t[s],!(e.indexOf(i)>=0)&&(o[i]=n[i]);return o}function ro(n,e){if(n==null)return{};var o=oo(n,e),t,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],!(e.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(n,t)&&(o[t]=n[t])}return o}const io={target(n){if(n)return()=>"current"in n?n.current:n},enabled(n=!0){return n},window(n=z.isBrowser?window:void 0){return n},eventOptions({passive:n=!0,capture:e=!1}={}){return{passive:n,capture:e}},transform(n){return n}},so=["target","eventOptions","window","enabled","transform"];function ye(n={},e){const o={};for(const[t,i]of Object.entries(e))switch(typeof i){case"function":o[t]=i.call(o,n[t],t,n);break;case"object":o[t]=ye(n[t],i);break;case"boolean":i&&(o[t]=n[t]);break}return o}function ao(n,e,o={}){const t=n,{target:i,eventOptions:s,window:h,enabled:a,transform:c}=t,p=ro(t,so);if(o.shared=ye({target:i,eventOptions:s,window:h,enabled:a,transform:c},io),e){const u=Ie.get(e);o[e]=ye(C({shared:o.shared},p),u)}else for(const u in p){const d=Ie.get(u);d&&(o[u]=ye(C({shared:o.shared},p[u]),d))}return o}class Lt{constructor(e,o){N(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=o}add(e,o,t,i,s){const h=this._listeners,a=An(o,t),c=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},p=C(C({},c),s);e.addEventListener(a,i,p);const u=()=>{e.removeEventListener(a,i,p),h.delete(u)};return h.add(u),u}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class co{constructor(){N(this,"_timeouts",new Map)}add(e,o,t=140,...i){this.remove(e),this._timeouts.set(e,window.setTimeout(o,t,...i))}remove(e){const o=this._timeouts.get(e);o&&window.clearTimeout(o)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class lo{constructor(e){N(this,"gestures",new Set),N(this,"_targetEventStore",new Lt(this)),N(this,"gestureEventStores",{}),N(this,"gestureTimeoutStores",{}),N(this,"handlers",{}),N(this,"config",{}),N(this,"pointerIds",new Set),N(this,"touchIds",new Set),N(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),uo(this,e)}setEventIds(e){if(_e(e))return this.touchIds=new Set(In(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,o){this.handlers=e,this.nativeHandlers=o}applyConfig(e,o){this.config=ao(e,o,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const o=this.config.shared,t={};let i;if(!(o.target&&(i=o.target(),!i))){if(o.enabled){for(const h of this.gestures){const a=this.config[h],c=gt(t,a.eventOptions,!!i);if(a.enabled){const p=Rt.get(h);new p(this,e,h).bind(c)}}const s=gt(t,o.eventOptions,!!i);for(const h in this.nativeHandlers)s(h,"",a=>this.nativeHandlers[h](C(C({},this.state.shared),{},{event:a,args:e})),void 0,!0)}for(const s in t)t[s]=Ln(...t[s]);if(!i)return t;for(const s in t){const{device:h,capture:a,passive:c}=Mn(s);this._targetEventStore.add(i,h,"",t[s],{capture:a,passive:c})}}}}function J(n,e){n.gestures.add(e),n.gestureEventStores[e]=new Lt(n,e),n.gestureTimeoutStores[e]=new co}function uo(n,e){e.drag&&J(n,"drag"),e.wheel&&J(n,"wheel"),e.scroll&&J(n,"scroll"),e.move&&J(n,"move"),e.pinch&&J(n,"pinch"),e.hover&&J(n,"hover")}const gt=(n,e,o)=>(t,i,s,h={},a=!1)=>{var c,p;const u=(c=h.capture)!==null&&c!==void 0?c:e.capture,d=(p=h.passive)!==null&&p!==void 0?p:e.passive;let b=a?t:Sn(t,i,u);o&&d&&(b+="Passive"),n[b]=n[b]||[],n[b].push(s)};function fo(n,e={},o,t){const i=Me.useMemo(()=>new lo(n),[]);if(i.applyHandlers(n,t),i.applyConfig(e,o),Me.useEffect(i.effect.bind(i)),Me.useEffect(()=>i.clean.bind(i),[]),e.target===void 0)return i.bind.bind(i)}function Ko(n,e){return to(no),fo({drag:n},e||{},"drag")}const ho=n=>(e,o,t)=>{const i=t.subscribe;return t.subscribe=(h,a,c)=>{let p=h;if(a){const u=(c==null?void 0:c.equalityFn)||Object.is;let d=h(t.getState());p=b=>{const w=h(b);if(!u(d,w)){const T=d;a(d=w,T)}},c!=null&&c.fireImmediately&&a(d,d)}return i(p)},n(e,o,t)},jt=f.createContext(null);function Bo({map:n,children:e,onChange:o,domElement:t}){const i=n.map(c=>c.name+c.keys).join("-"),s=f.useMemo(()=>cn(ho(()=>n.reduce((c,p)=>({...c,[p.name]:!1}),{}))),[i]),h=f.useMemo(()=>[s.subscribe,s.getState,s],[i]),a=s.setState;return f.useEffect(()=>{const p=n.map(({name:w,keys:T,up:P})=>({keys:T,up:P,fn:M=>{a({[w]:M}),o&&o(w,M,h[1]())}})).reduce((w,{keys:T,fn:P,up:M=!0})=>(T.forEach(x=>w[x]={fn:P,pressed:!1,up:M}),w),{}),u=({key:w,code:T})=>{const P=p[w]||p[T];if(!P)return;const{fn:M,pressed:x,up:v}=P;P.pressed=!0,(v||!x)&&M(!0)},d=({key:w,code:T})=>{const P=p[w]||p[T];if(!P)return;const{fn:M,up:x}=P;P.pressed=!1,x&&M(!1)},b=t||window;return b.addEventListener("keydown",u,{passive:!0}),b.addEventListener("keyup",d,{passive:!0}),()=>{b.removeEventListener("keydown",u),b.removeEventListener("keyup",d)}},[t,i]),f.createElement(jt.Provider,{value:h,children:e})}function Yo(n){const[e,o,t]=f.useContext(jt);return[e,o]}const po=parseInt(St.replace(/\D+/g,""));var mo=Object.defineProperty,go=(n,e,o)=>e in n?mo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,Ut=(n,e,o)=>(go(n,typeof e!="symbol"?e+"":e,o),o);const be={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new D},up:{value:new D(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${po>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},Nt=new Ot({name:"SkyShader",fragmentShader:be.fragmentShader,vertexShader:be.vertexShader,uniforms:Mt.clone(be.uniforms),side:fn,depthWrite:!1});let je=class extends hn{constructor(){super(new dn(1,1,1),Nt)}};Ut(je,"SkyShader",be);Ut(je,"material",Nt);var yo=Object.defineProperty,bo=(n,e,o)=>e in n?yo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,g=(n,e,o)=>(bo(n,typeof e!="symbol"?e+"":e,o),o);const de=new pn,yt=new mn,vo=Math.cos(70*(Math.PI/180)),bt=(n,e)=>(n%e+e)%e;let Eo=class extends gn{constructor(e,o){super(),g(this,"object"),g(this,"domElement"),g(this,"enabled",!0),g(this,"target",new D),g(this,"minDistance",0),g(this,"maxDistance",1/0),g(this,"minZoom",0),g(this,"maxZoom",1/0),g(this,"minPolarAngle",0),g(this,"maxPolarAngle",Math.PI),g(this,"minAzimuthAngle",-1/0),g(this,"maxAzimuthAngle",1/0),g(this,"enableDamping",!1),g(this,"dampingFactor",.05),g(this,"enableZoom",!0),g(this,"zoomSpeed",1),g(this,"enableRotate",!0),g(this,"rotateSpeed",1),g(this,"enablePan",!0),g(this,"panSpeed",1),g(this,"screenSpacePanning",!0),g(this,"keyPanSpeed",7),g(this,"zoomToCursor",!1),g(this,"autoRotate",!1),g(this,"autoRotateSpeed",2),g(this,"reverseOrbit",!1),g(this,"reverseHorizontalOrbit",!1),g(this,"reverseVerticalOrbit",!1),g(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),g(this,"mouseButtons",{LEFT:q.ROTATE,MIDDLE:q.DOLLY,RIGHT:q.PAN}),g(this,"touches",{ONE:Q.ROTATE,TWO:Q.DOLLY_PAN}),g(this,"target0"),g(this,"position0"),g(this,"zoom0"),g(this,"_domElementKeyEvents",null),g(this,"getPolarAngle"),g(this,"getAzimuthalAngle"),g(this,"setPolarAngle"),g(this,"setAzimuthalAngle"),g(this,"getDistance"),g(this,"listenToKeyEvents"),g(this,"stopListenToKeyEvents"),g(this,"saveState"),g(this,"reset"),g(this,"update"),g(this,"connect"),g(this,"dispose"),this.object=e,this.domElement=o,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=r=>{let l=bt(r,2*Math.PI),y=u.phi;y<0&&(y+=2*Math.PI),l<0&&(l+=2*Math.PI);let O=Math.abs(l-y);2*Math.PI-O<O&&(l<y?l+=2*Math.PI:y+=2*Math.PI),d.phi=l-y,t.update()},this.setAzimuthalAngle=r=>{let l=bt(r,2*Math.PI),y=u.theta;y<0&&(y+=2*Math.PI),l<0&&(l+=2*Math.PI);let O=Math.abs(l-y);2*Math.PI-O<O&&(l<y?l+=2*Math.PI:y+=2*Math.PI),d.theta=l-y,t.update()},this.getDistance=()=>t.object.position.distanceTo(t.target),this.listenToKeyEvents=r=>{r.addEventListener("keydown",Se),this._domElementKeyEvents=r},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Se),this._domElementKeyEvents=null},this.saveState=()=>{t.target0.copy(t.target),t.position0.copy(t.object.position),t.zoom0=t.object.zoom},this.reset=()=>{t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),t.dispatchEvent(i),t.update(),c=a.NONE},this.update=(()=>{const r=new D,l=new D(0,1,0),y=new se().setFromUnitVectors(e.up,l),O=y.clone().invert(),R=new D,B=new se,W=2*Math.PI;return function(){const nt=t.object.position;y.setFromUnitVectors(e.up,l),O.copy(y).invert(),r.copy(nt).sub(t.target),r.applyQuaternion(y),u.setFromVector3(r),t.autoRotate&&c===a.NONE&&we(Bt()),t.enableDamping?(u.theta+=d.theta*t.dampingFactor,u.phi+=d.phi*t.dampingFactor):(u.theta+=d.theta,u.phi+=d.phi);let Y=t.minAzimuthAngle,V=t.maxAzimuthAngle;isFinite(Y)&&isFinite(V)&&(Y<-Math.PI?Y+=W:Y>Math.PI&&(Y-=W),V<-Math.PI?V+=W:V>Math.PI&&(V-=W),Y<=V?u.theta=Math.max(Y,Math.min(V,u.theta)):u.theta=u.theta>(Y+V)/2?Math.max(Y,u.theta):Math.min(V,u.theta)),u.phi=Math.max(t.minPolarAngle,Math.min(t.maxPolarAngle,u.phi)),u.makeSafe(),t.enableDamping===!0?t.target.addScaledVector(w,t.dampingFactor):t.target.add(w),t.zoomToCursor&&k||t.object.isOrthographicCamera?u.radius=Pe(u.radius):u.radius=Pe(u.radius*b),r.setFromSpherical(u),r.applyQuaternion(O),nt.copy(t.target).add(r),t.object.matrixAutoUpdate||t.object.updateMatrix(),t.object.lookAt(t.target),t.enableDamping===!0?(d.theta*=1-t.dampingFactor,d.phi*=1-t.dampingFactor,w.multiplyScalar(1-t.dampingFactor)):(d.set(0,0,0),w.set(0,0,0));let te=!1;if(t.zoomToCursor&&k){let ne=null;if(t.object instanceof fe&&t.object.isPerspectiveCamera){const oe=r.length();ne=Pe(oe*b);const ue=oe-ne;t.object.position.addScaledVector(U,ue),t.object.updateMatrixWorld()}else if(t.object.isOrthographicCamera){const oe=new D(A.x,A.y,0);oe.unproject(t.object),t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/b)),t.object.updateProjectionMatrix(),te=!0;const ue=new D(A.x,A.y,0);ue.unproject(t.object),t.object.position.sub(ue).add(oe),t.object.updateMatrixWorld(),ne=r.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),t.zoomToCursor=!1;ne!==null&&(t.screenSpacePanning?t.target.set(0,0,-1).transformDirection(t.object.matrix).multiplyScalar(ne).add(t.object.position):(de.origin.copy(t.object.position),de.direction.set(0,0,-1).transformDirection(t.object.matrix),Math.abs(t.object.up.dot(de.direction))<vo?e.lookAt(t.target):(yt.setFromNormalAndCoplanarPoint(t.object.up,t.target),de.intersectPlane(yt,t.target))))}else t.object instanceof he&&t.object.isOrthographicCamera&&(te=b!==1,te&&(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/b)),t.object.updateProjectionMatrix()));return b=1,k=!1,te||R.distanceToSquared(t.object.position)>p||8*(1-B.dot(t.object.quaternion))>p?(t.dispatchEvent(i),R.copy(t.object.position),B.copy(t.object.quaternion),te=!1,!0):!1}})(),this.connect=r=>{r===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),t.domElement=r,t.domElement.style.touchAction="none",t.domElement.addEventListener("contextmenu",et),t.domElement.addEventListener("pointerdown",Qe),t.domElement.addEventListener("pointercancel",ee),t.domElement.addEventListener("wheel",Je)},this.dispose=()=>{var r,l,y,O,R,B;t.domElement&&(t.domElement.style.touchAction="auto"),(r=t.domElement)==null||r.removeEventListener("contextmenu",et),(l=t.domElement)==null||l.removeEventListener("pointerdown",Qe),(y=t.domElement)==null||y.removeEventListener("pointercancel",ee),(O=t.domElement)==null||O.removeEventListener("wheel",Je),(R=t.domElement)==null||R.ownerDocument.removeEventListener("pointermove",xe),(B=t.domElement)==null||B.ownerDocument.removeEventListener("pointerup",ee),t._domElementKeyEvents!==null&&t._domElementKeyEvents.removeEventListener("keydown",Se)};const t=this,i={type:"change"},s={type:"start"},h={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let c=a.NONE;const p=1e-6,u=new ot,d=new ot;let b=1;const w=new D,T=new K,P=new K,M=new K,x=new K,v=new K,E=new K,I=new K,S=new K,m=new K,U=new D,A=new K;let k=!1;const _=[],G={};function Bt(){return 2*Math.PI/60/60*t.autoRotateSpeed}function le(){return Math.pow(.95,t.zoomSpeed)}function we(r){t.reverseOrbit||t.reverseHorizontalOrbit?d.theta+=r:d.theta-=r}function ze(r){t.reverseOrbit||t.reverseVerticalOrbit?d.phi+=r:d.phi-=r}const Fe=(()=>{const r=new D;return function(y,O){r.setFromMatrixColumn(O,0),r.multiplyScalar(-y),w.add(r)}})(),Ke=(()=>{const r=new D;return function(y,O){t.screenSpacePanning===!0?r.setFromMatrixColumn(O,1):(r.setFromMatrixColumn(O,0),r.crossVectors(t.object.up,r)),r.multiplyScalar(y),w.add(r)}})(),$=(()=>{const r=new D;return function(y,O){const R=t.domElement;if(R&&t.object instanceof fe&&t.object.isPerspectiveCamera){const B=t.object.position;r.copy(B).sub(t.target);let W=r.length();W*=Math.tan(t.object.fov/2*Math.PI/180),Fe(2*y*W/R.clientHeight,t.object.matrix),Ke(2*O*W/R.clientHeight,t.object.matrix)}else R&&t.object instanceof he&&t.object.isOrthographicCamera?(Fe(y*(t.object.right-t.object.left)/t.object.zoom/R.clientWidth,t.object.matrix),Ke(O*(t.object.top-t.object.bottom)/t.object.zoom/R.clientHeight,t.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),t.enablePan=!1)}})();function Te(r){t.object instanceof fe&&t.object.isPerspectiveCamera||t.object instanceof he&&t.object.isOrthographicCamera?b/=r:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function Be(r){t.object instanceof fe&&t.object.isPerspectiveCamera||t.object instanceof he&&t.object.isOrthographicCamera?b*=r:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function Ye(r){if(!t.zoomToCursor||!t.domElement)return;k=!0;const l=t.domElement.getBoundingClientRect(),y=r.clientX-l.left,O=r.clientY-l.top,R=l.width,B=l.height;A.x=y/R*2-1,A.y=-(O/B)*2+1,U.set(A.x,A.y,1).unproject(t.object).sub(t.object.position).normalize()}function Pe(r){return Math.max(t.minDistance,Math.min(t.maxDistance,r))}function Ve(r){T.set(r.clientX,r.clientY)}function Yt(r){Ye(r),I.set(r.clientX,r.clientY)}function He(r){x.set(r.clientX,r.clientY)}function Vt(r){P.set(r.clientX,r.clientY),M.subVectors(P,T).multiplyScalar(t.rotateSpeed);const l=t.domElement;l&&(we(2*Math.PI*M.x/l.clientHeight),ze(2*Math.PI*M.y/l.clientHeight)),T.copy(P),t.update()}function Ht(r){S.set(r.clientX,r.clientY),m.subVectors(S,I),m.y>0?Te(le()):m.y<0&&Be(le()),I.copy(S),t.update()}function Wt(r){v.set(r.clientX,r.clientY),E.subVectors(v,x).multiplyScalar(t.panSpeed),$(E.x,E.y),x.copy(v),t.update()}function Xt(r){Ye(r),r.deltaY<0?Be(le()):r.deltaY>0&&Te(le()),t.update()}function Zt(r){let l=!1;switch(r.code){case t.keys.UP:$(0,t.keyPanSpeed),l=!0;break;case t.keys.BOTTOM:$(0,-t.keyPanSpeed),l=!0;break;case t.keys.LEFT:$(t.keyPanSpeed,0),l=!0;break;case t.keys.RIGHT:$(-t.keyPanSpeed,0),l=!0;break}l&&(r.preventDefault(),t.update())}function We(){if(_.length==1)T.set(_[0].pageX,_[0].pageY);else{const r=.5*(_[0].pageX+_[1].pageX),l=.5*(_[0].pageY+_[1].pageY);T.set(r,l)}}function Xe(){if(_.length==1)x.set(_[0].pageX,_[0].pageY);else{const r=.5*(_[0].pageX+_[1].pageX),l=.5*(_[0].pageY+_[1].pageY);x.set(r,l)}}function Ze(){const r=_[0].pageX-_[1].pageX,l=_[0].pageY-_[1].pageY,y=Math.sqrt(r*r+l*l);I.set(0,y)}function Gt(){t.enableZoom&&Ze(),t.enablePan&&Xe()}function $t(){t.enableZoom&&Ze(),t.enableRotate&&We()}function Ge(r){if(_.length==1)P.set(r.pageX,r.pageY);else{const y=Oe(r),O=.5*(r.pageX+y.x),R=.5*(r.pageY+y.y);P.set(O,R)}M.subVectors(P,T).multiplyScalar(t.rotateSpeed);const l=t.domElement;l&&(we(2*Math.PI*M.x/l.clientHeight),ze(2*Math.PI*M.y/l.clientHeight)),T.copy(P)}function $e(r){if(_.length==1)v.set(r.pageX,r.pageY);else{const l=Oe(r),y=.5*(r.pageX+l.x),O=.5*(r.pageY+l.y);v.set(y,O)}E.subVectors(v,x).multiplyScalar(t.panSpeed),$(E.x,E.y),x.copy(v)}function qe(r){const l=Oe(r),y=r.pageX-l.x,O=r.pageY-l.y,R=Math.sqrt(y*y+O*O);S.set(0,R),m.set(0,Math.pow(S.y/I.y,t.zoomSpeed)),Te(m.y),I.copy(S)}function qt(r){t.enableZoom&&qe(r),t.enablePan&&$e(r)}function Qt(r){t.enableZoom&&qe(r),t.enableRotate&&Ge(r)}function Qe(r){var l,y;t.enabled!==!1&&(_.length===0&&((l=t.domElement)==null||l.ownerDocument.addEventListener("pointermove",xe),(y=t.domElement)==null||y.ownerDocument.addEventListener("pointerup",ee)),on(r),r.pointerType==="touch"?tn(r):Jt(r))}function xe(r){t.enabled!==!1&&(r.pointerType==="touch"?nn(r):en(r))}function ee(r){var l,y,O;rn(r),_.length===0&&((l=t.domElement)==null||l.releasePointerCapture(r.pointerId),(y=t.domElement)==null||y.ownerDocument.removeEventListener("pointermove",xe),(O=t.domElement)==null||O.ownerDocument.removeEventListener("pointerup",ee)),t.dispatchEvent(h),c=a.NONE}function Jt(r){let l;switch(r.button){case 0:l=t.mouseButtons.LEFT;break;case 1:l=t.mouseButtons.MIDDLE;break;case 2:l=t.mouseButtons.RIGHT;break;default:l=-1}switch(l){case q.DOLLY:if(t.enableZoom===!1)return;Yt(r),c=a.DOLLY;break;case q.ROTATE:if(r.ctrlKey||r.metaKey||r.shiftKey){if(t.enablePan===!1)return;He(r),c=a.PAN}else{if(t.enableRotate===!1)return;Ve(r),c=a.ROTATE}break;case q.PAN:if(r.ctrlKey||r.metaKey||r.shiftKey){if(t.enableRotate===!1)return;Ve(r),c=a.ROTATE}else{if(t.enablePan===!1)return;He(r),c=a.PAN}break;default:c=a.NONE}c!==a.NONE&&t.dispatchEvent(s)}function en(r){if(t.enabled!==!1)switch(c){case a.ROTATE:if(t.enableRotate===!1)return;Vt(r);break;case a.DOLLY:if(t.enableZoom===!1)return;Ht(r);break;case a.PAN:if(t.enablePan===!1)return;Wt(r);break}}function Je(r){t.enabled===!1||t.enableZoom===!1||c!==a.NONE&&c!==a.ROTATE||(r.preventDefault(),t.dispatchEvent(s),Xt(r),t.dispatchEvent(h))}function Se(r){t.enabled===!1||t.enablePan===!1||Zt(r)}function tn(r){switch(tt(r),_.length){case 1:switch(t.touches.ONE){case Q.ROTATE:if(t.enableRotate===!1)return;We(),c=a.TOUCH_ROTATE;break;case Q.PAN:if(t.enablePan===!1)return;Xe(),c=a.TOUCH_PAN;break;default:c=a.NONE}break;case 2:switch(t.touches.TWO){case Q.DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;Gt(),c=a.TOUCH_DOLLY_PAN;break;case Q.DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;$t(),c=a.TOUCH_DOLLY_ROTATE;break;default:c=a.NONE}break;default:c=a.NONE}c!==a.NONE&&t.dispatchEvent(s)}function nn(r){switch(tt(r),c){case a.TOUCH_ROTATE:if(t.enableRotate===!1)return;Ge(r),t.update();break;case a.TOUCH_PAN:if(t.enablePan===!1)return;$e(r),t.update();break;case a.TOUCH_DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;qt(r),t.update();break;case a.TOUCH_DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;Qt(r),t.update();break;default:c=a.NONE}}function et(r){t.enabled!==!1&&r.preventDefault()}function on(r){_.push(r)}function rn(r){delete G[r.pointerId];for(let l=0;l<_.length;l++)if(_[l].pointerId==r.pointerId){_.splice(l,1);return}}function tt(r){let l=G[r.pointerId];l===void 0&&(l=new K,G[r.pointerId]=l),l.set(r.pageX,r.pageY)}function Oe(r){const l=r.pointerId===_[0].pointerId?_[1]:_[0];return G[l.pointerId]}o!==void 0&&this.connect(o),this.update()}};function Wo(n,e){if(Object.is(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;const o=Object.keys(n);if(o.length!==Object.keys(e).length)return!1;for(let t=0;t<o.length;t++)if(!Object.prototype.hasOwnProperty.call(e,o[t])||!Object.is(n[o[t]],e[o[t]]))return!1;return!0}function Zo(n,e,o,t){const i=class extends Ot{constructor(h={}){const a=Object.entries(n);super({uniforms:a.reduce((c,[p,u])=>{const d=Mt.clone({[p]:{value:u}});return{...c,...d}},{}),vertexShader:e,fragmentShader:o}),this.key="",a.forEach(([c])=>Object.defineProperty(this,c,{get:()=>this.uniforms[c].value,set:p=>this.uniforms[c].value=p})),Object.assign(this,h)}};return i.key=yn.generateUUID(),i}const De=n=>n===Object(n)&&!Array.isArray(n)&&typeof n!="function";function Ue(n,e){const o=H(s=>s.gl),t=ke(Re,De(n)?Object.values(n):n);return f.useLayoutEffect(()=>{e==null||e(t)},[e]),f.useEffect(()=>{if("initTexture"in o){let s=[];Array.isArray(t)?s=t:t instanceof rt?s=[t]:De(t)&&(s=Object.values(t)),s.forEach(h=>{h instanceof rt&&o.initTexture(h)})}},[o,t]),f.useMemo(()=>{if(De(n)){const s={};let h=0;for(const a in n)s[a]=t[h++];return console.log("keyed",s),s}else return t},[n,t])}Ue.preload=n=>ke.preload(Re,n);Ue.clear=n=>ke.clear(Re,n);const Go=f.forwardRef(({makeDefault:n,camera:e,regress:o,domElement:t,enableDamping:i=!0,keyEvents:s=!1,onChange:h,onStart:a,onEnd:c,...p},u)=>{const d=H(m=>m.invalidate),b=H(m=>m.camera),w=H(m=>m.gl),T=H(m=>m.events),P=H(m=>m.setEvents),M=H(m=>m.set),x=H(m=>m.get),v=H(m=>m.performance),E=e||b,I=t||T.connected||w.domElement,S=f.useMemo(()=>new Eo(E),[E]);return Ee(()=>{S.enabled&&S.update()},-1),f.useEffect(()=>(s&&S.connect(s===!0?I:s),S.connect(I),()=>void S.dispose()),[s,I,o,S,d]),f.useEffect(()=>{const m=k=>{d(),o&&v.regress(),h&&h(k)},U=k=>{a&&a(k)},A=k=>{c&&c(k)};return S.addEventListener("change",m),S.addEventListener("start",U),S.addEventListener("end",A),()=>{S.removeEventListener("start",U),S.removeEventListener("end",A),S.removeEventListener("change",m)}},[h,a,c,S,d,P]),f.useEffect(()=>{if(n){const m=x().controls;return M({controls:S}),()=>M({controls:m})}},[n,S]),f.createElement("primitive",F({ref:u,object:S,enableDamping:i},p))});var zt={exports:{}},_o="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",wo=_o,To=wo;function Ft(){}function Kt(){}Kt.resetWarningCache=Ft;var Po=function(){function n(t,i,s,h,a,c){if(c!==To){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}n.isRequired=n;function e(){return n}var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Kt,resetWarningCache:Ft};return o.PropTypes=o,o};zt.exports=Po();var xo=zt.exports;const $o=an(xo),Ce=(n,e)=>{"updateRanges"in n?n.updateRanges[0]=e:n.updateRange=e};function So(n,e,o=new D){const t=Math.PI*(n-.5),i=2*Math.PI*(e-.5);return o.x=Math.cos(i),o.y=Math.sin(t),o.z=Math.sin(i),o}const qo=f.forwardRef(({inclination:n=.6,azimuth:e=.1,distance:o=1e3,mieCoefficient:t=.005,mieDirectionalG:i=.8,rayleigh:s=.5,turbidity:h=10,sunPosition:a=So(n,e),...c},p)=>{const u=f.useMemo(()=>new D().setScalar(o),[o]),[d]=f.useState(()=>new je);return f.createElement("primitive",F({object:d,ref:p,"material-uniforms-mieCoefficient-value":t,"material-uniforms-mieDirectionalG-value":i,"material-uniforms-rayleigh-value":s,"material-uniforms-sunPosition-value":a,"material-uniforms-turbidity-value":h,scale:u},c))});let pe;const Oo=new Uint8Array(16);function Mo(){if(!pe&&(pe=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pe))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pe(Oo)}const L=[];for(let n=0;n<256;++n)L.push((n+256).toString(16).slice(1));function Ao(n,e=0){return L[n[e+0]]+L[n[e+1]]+L[n[e+2]]+L[n[e+3]]+"-"+L[n[e+4]]+L[n[e+5]]+"-"+L[n[e+6]]+L[n[e+7]]+"-"+L[n[e+8]]+L[n[e+9]]+"-"+L[n[e+10]]+L[n[e+11]]+L[n[e+12]]+L[n[e+13]]+L[n[e+14]]+L[n[e+15]]}const Do=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),vt={randomUUID:Do};function Co(n,e,o){if(vt.randomUUID&&!e&&!n)return vt.randomUUID();n=n||{};const t=n.random||(n.rng||Mo)();return t[6]=t[6]&15|64,t[8]=t[8]&63|128,Ao(t)}const Io="https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png",Et=new Le,me=new D,ge=new se,_t=new D,wt=new se,re=new D,Ne=f.createContext(null),ko=f.forwardRef(({children:n,material:e=bn,texture:o=Io,range:t,limit:i=200,frustumCulled:s,...h},a)=>{var c,p;const u=f.useMemo(()=>class extends e{constructor(){super();const A=parseInt(St.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=k=>{k.vertexShader=`attribute float opacity;
               varying float vOpacity;
              `+k.vertexShader.replace("#include <fog_vertex>",`#include <fog_vertex>
                 vOpacity = opacity;
                `),k.fragmentShader=`varying float vOpacity;
              `+k.fragmentShader.replace(`#include <${A}>`,`#include <${A}>
                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);
                `)}}},[e]);ln({CloudMaterial:u});const d=f.useRef(null),b=f.useRef([]),w=f.useMemo(()=>new Float32Array(Array.from({length:i},()=>1)),[i]),T=f.useMemo(()=>new Float32Array(Array.from({length:i},()=>[1,1,1]).flat()),[i]),P=Ue(o);let M=0,x=0,v;const E=new se,I=new D(0,0,1),S=new D;Ee((A,k)=>{for(M=A.clock.getElapsedTime(),Et.copy(d.current.matrixWorld).invert(),A.camera.matrixWorld.decompose(_t,wt,re),x=0;x<b.current.length;x++)v=b.current[x],v.ref.current.matrixWorld.decompose(me,ge,re),me.add(S.copy(v.position).applyQuaternion(ge).multiply(re)),ge.copy(wt).multiply(E.setFromAxisAngle(I,v.rotation+=k*v.rotationFactor)),re.multiplyScalar(v.volume+(1+Math.sin(M*v.density*v.speed))/2*v.growth),v.matrix.compose(me,ge,re).premultiply(Et),v.dist=me.distanceTo(_t);for(b.current.sort((_,G)=>G.dist-_.dist),x=0;x<b.current.length;x++)v=b.current[x],w[x]=v.opacity*(v.dist<v.fade-1?v.dist/v.fade:1),d.current.setMatrixAt(x,v.matrix),d.current.setColorAt(x,v.color);d.current.geometry.attributes.opacity.needsUpdate=!0,d.current.instanceMatrix.needsUpdate=!0,d.current.instanceColor&&(d.current.instanceColor.needsUpdate=!0)}),f.useLayoutEffect(()=>{const A=Math.min(i,t!==void 0?t:i,b.current.length);d.current.count=A,Ce(d.current.instanceMatrix,{offset:0,count:A*16}),d.current.instanceColor&&Ce(d.current.instanceColor,{offset:0,count:A*3}),Ce(d.current.geometry.attributes.opacity,{offset:0,count:A})});let m=[(c=P.image.width)!==null&&c!==void 0?c:1,(p=P.image.height)!==null&&p!==void 0?p:1],U=Math.max(m[0],m[1]);return m=[m[0]/U,m[1]/U],f.createElement("group",F({ref:a},h),f.createElement(Ne.Provider,{value:b},n,f.createElement("instancedMesh",{matrixAutoUpdate:!1,ref:d,args:[null,null,i],frustumCulled:s},f.createElement("instancedBufferAttribute",{usage:X,attach:"instanceColor",args:[T,3]}),f.createElement("planeGeometry",{args:[...m]},f.createElement("instancedBufferAttribute",{usage:X,attach:"attributes-opacity",args:[w,1]})),f.createElement("cloudMaterial",{key:e.name,map:P,transparent:!0,depthWrite:!1}))))}),Tt=f.forwardRef(({opacity:n=1,speed:e=0,bounds:o=[5,1,1],segments:t=20,color:i="#ffffff",fade:s=10,volume:h=6,smallestVolume:a=.25,distribute:c=null,growth:p=4,concentrate:u="inside",seed:d=Math.random(),...b},w)=>{function T(){const E=Math.sin(d++)*1e4;return E-Math.floor(E)}const P=f.useContext(Ne),M=f.useRef(null),[x]=f.useState(()=>Co()),v=f.useMemo(()=>[...new Array(t)].map((E,I)=>({segments:t,bounds:new D(1,1,1),position:new D,uuid:x,index:I,ref:M,dist:0,matrix:new Le,color:new vn,rotation:I*(Math.PI/t)})),[t,x]);return f.useLayoutEffect(()=>{v.forEach((E,I)=>{var S;un(E,{volume:h,color:i,speed:e,growth:p,opacity:n,fade:s,bounds:o,density:Math.max(.5,T()),rotationFactor:Math.max(.2,.5*T())*e});const m=c==null?void 0:c(E,I);(m||t>1)&&E.position.copy(E.bounds).multiply((S=m==null?void 0:m.point)!==null&&S!==void 0?S:{x:T()*2-1,y:T()*2-1,z:T()*2-1});const U=Math.abs(E.position.x),A=Math.abs(E.position.y),k=Math.abs(E.position.z),_=Math.max(U,A,k);E.length=1,U===_&&(E.length-=U/E.bounds.x),A===_&&(E.length-=A/E.bounds.y),k===_&&(E.length-=k/E.bounds.z),E.volume=((m==null?void 0:m.volume)!==void 0?m.volume:Math.max(Math.max(0,a),u==="random"?T():u==="inside"?E.length:1-E.length))*h})},[u,o,s,i,n,p,h,d,t,e]),f.useLayoutEffect(()=>{const E=v;return P.current=[...P.current,...E],()=>{P.current=P.current.filter(I=>I.uuid!==x)}},[v]),f.useImperativeHandle(w,()=>M.current,[]),f.createElement("group",F({ref:M},b))}),Qo=f.forwardRef((n,e)=>f.useContext(Ne)?f.createElement(Tt,F({ref:e},n)):f.createElement(ko,null,f.createElement(Tt,F({ref:e},n))));let Z,ie;const Ro=f.createContext(null),Pt=new Le,xt=new D,Lo=f.forwardRef(({children:n,range:e,limit:o=1e3,...t},i)=>{const s=f.useRef(null);f.useImperativeHandle(i,()=>s.current,[]);const[h,a]=f.useState([]),[[c,p,u]]=f.useState(()=>[new Float32Array(o*3),Float32Array.from({length:o*3},()=>1),Float32Array.from({length:o},()=>1)]);f.useEffect(()=>{s.current.geometry.attributes.position.needsUpdate=!0}),Ee(()=>{for(s.current.updateMatrix(),s.current.updateMatrixWorld(),Pt.copy(s.current.matrixWorld).invert(),s.current.geometry.drawRange.count=Math.min(o,e!==void 0?e:o,h.length),Z=0;Z<h.length;Z++)ie=h[Z].current,ie.getWorldPosition(xt).applyMatrix4(Pt),xt.toArray(c,Z*3),s.current.geometry.attributes.position.needsUpdate=!0,ie.matrixWorldNeedsUpdate=!0,ie.color.toArray(p,Z*3),s.current.geometry.attributes.color.needsUpdate=!0,u.set([ie.size],Z),s.current.geometry.attributes.size.needsUpdate=!0});const d=f.useMemo(()=>({getParent:()=>s,subscribe:b=>(a(w=>[...w,b]),()=>a(w=>w.filter(T=>T.current!==b.current)))}),[]);return f.createElement("points",F({userData:{instances:h},matrixAutoUpdate:!1,ref:s,raycast:()=>null},t),f.createElement("bufferGeometry",null,f.createElement("bufferAttribute",{attach:"attributes-position",count:c.length/3,array:c,itemSize:3,usage:X}),f.createElement("bufferAttribute",{attach:"attributes-color",count:p.length/3,array:p,itemSize:3,usage:X}),f.createElement("bufferAttribute",{attach:"attributes-size",count:u.length,array:u,itemSize:1,usage:X})),f.createElement(Ro.Provider,{value:d},n))}),jo=f.forwardRef(({children:n,positions:e,colors:o,sizes:t,stride:i=3,...s},h)=>{const a=f.useRef(null);return f.useImperativeHandle(h,()=>a.current,[]),Ee(()=>{const c=a.current.geometry.attributes;c.position.needsUpdate=!0,o&&(c.color.needsUpdate=!0),t&&(c.size.needsUpdate=!0)}),f.createElement("points",F({ref:a},s),f.createElement("bufferGeometry",null,f.createElement("bufferAttribute",{attach:"attributes-position",count:e.length/i,array:e,itemSize:i,usage:X}),o&&f.createElement("bufferAttribute",{attach:"attributes-color",count:o.length/i,array:o,itemSize:3,usage:X}),t&&f.createElement("bufferAttribute",{attach:"attributes-size",count:t.length/i,array:t,itemSize:1,usage:X})),n)}),Jo=f.forwardRef((n,e)=>n.positions instanceof Float32Array?f.createElement(jo,F({},n,{ref:e})):f.createElement(Lo,F({},n,{ref:e})));export{ko as C,Bo as K,Go as O,$o as P,qo as S,F as _,ho as a,Zo as b,Ue as c,Jo as d,Qo as e,Yo as f,it as g,Wo as s,Ko as u};
