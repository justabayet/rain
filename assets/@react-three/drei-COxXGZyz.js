import{a as tn,R as Pe,r as m,g as nn}from"../react-dom-ZcwTowb8.js";import{c as on,u as V,a as Ae,b as Et,e as sn,d as rn}from"./fiber-DqavkFx2.js";import{j as _t,V as C,k as wt,l as Tt,m as an,n as cn,o as ln,p as un,q as fn,E as hn,r as G,s as $,Q as oe,P as ce,O as le,t as Qe,c as F,u as dn,v as De,T as Je,D as et,w as pn,x as Pt,C as mn}from"../three-O-IJA8ay.js";var tt={},nt=tn;tt.createRoot=nt.createRoot,tt.hydrateRoot=nt.hydrateRoot;function W(){return W=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var t in o)({}).hasOwnProperty.call(o,t)&&(n[t]=o[t])}return n},W.apply(null,arguments)}function gn(n,e,o){return Math.max(e,Math.min(n,o))}const j={toVector(n,e){return n===void 0&&(n=e),Array.isArray(n)?n:[n,n]},add(n,e){return[n[0]+e[0],n[1]+e[1]]},sub(n,e){return[n[0]-e[0],n[1]-e[1]]},addTo(n,e){n[0]+=e[0],n[1]+=e[1]},subTo(n,e){n[0]-=e[0],n[1]-=e[1]}};function ot(n,e,o){return e===0||Math.abs(e)===1/0?Math.pow(n,o*5):n*e*o/(e+o*n)}function it(n,e,o,t=.15){return t===0?gn(n,e,o):n<e?-ot(e-n,o-e,t)+e:n>o?+ot(n-o,o-e,t)+o:n}function yn(n,[e,o],[t,s]){const[[a,f],[r,l]]=n;return[it(e,a,f,t),it(o,r,l,s)]}function bn(n,e){if(typeof n!="object"||n===null)return n;var o=n[Symbol.toPrimitive];if(o!==void 0){var t=o.call(n,e||"default");if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vn(n){var e=bn(n,"string");return typeof e=="symbol"?e:String(e)}function N(n,e,o){return e=vn(e),e in n?Object.defineProperty(n,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[e]=o,n}function st(n,e){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),o.push.apply(o,t)}return o}function D(n){for(var e=1;e<arguments.length;e++){var o=arguments[e]!=null?arguments[e]:{};e%2?st(Object(o),!0).forEach(function(t){N(n,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):st(Object(o)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(o,t))})}return n}const xt={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function rt(n){return n?n[0].toUpperCase()+n.slice(1):""}const En=["enter","leave"];function _n(n=!1,e){return n&&!En.includes(e)}function wn(n,e="",o=!1){const t=xt[n],s=t&&t[e]||e;return"on"+rt(n)+rt(s)+(_n(o,s)?"Capture":"")}const Tn=["gotpointercapture","lostpointercapture"];function Pn(n){let e=n.substring(2).toLowerCase();const o=!!~e.indexOf("passive");o&&(e=e.replace("passive",""));const t=Tn.includes(e)?"capturecapture":"capture",s=!!~e.indexOf(t);return s&&(e=e.replace("capture","")),{device:e,capture:s,passive:o}}function xn(n,e=""){const o=xt[n],t=o&&o[e]||e;return n+t}function ye(n){return"touches"in n}function Ot(n){return ye(n)?"touch":"pointerType"in n?n.pointerType:"mouse"}function On(n){return Array.from(n.touches).filter(e=>{var o,t;return e.target===n.currentTarget||((o=n.currentTarget)===null||o===void 0||(t=o.contains)===null||t===void 0?void 0:t.call(o,e.target))})}function Sn(n){return n.type==="touchend"||n.type==="touchcancel"?n.changedTouches:n.targetTouches}function St(n){return ye(n)?Sn(n)[0]:n}function Mn(n){return On(n).map(e=>e.identifier)}function xe(n){const e=St(n);return ye(n)?e.identifier:e.pointerId}function at(n){const e=St(n);return[e.clientX,e.clientY]}function An(n){const e={};if("buttons"in n&&(e.buttons=n.buttons),"shiftKey"in n){const{shiftKey:o,altKey:t,metaKey:s,ctrlKey:a}=n;Object.assign(e,{shiftKey:o,altKey:t,metaKey:s,ctrlKey:a})}return e}function ge(n,...e){return typeof n=="function"?n(...e):n}function Dn(){}function Cn(...n){return n.length===0?Dn:n.length===1?n[0]:function(){let e;for(const o of n)e=o.apply(this,arguments)||e;return e}}function ct(n,e){return Object.assign({},e,n||{})}const In=32;class kn{constructor(e,o,t){this.ctrl=e,this.args=o,this.key=t,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:o,ingKey:t,args:s}=this;o[t]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=s,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const o=this.state,t=this.config;o._active||(this.reset(),this.computeInitial(),o._active=!0,o.target=e.target,o.currentTarget=e.currentTarget,o.lastOffset=t.from?ge(t.from,o):o.offset,o.offset=o.lastOffset,o.startTime=o.timeStamp=e.timeStamp)}computeValues(e){const o=this.state;o._values=e,o.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:o,config:t,shared:s}=this;o.args=this.args;let a=0;if(e&&(o.event=e,t.preventDefault&&e.cancelable&&o.event.preventDefault(),o.type=e.type,s.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,s.locked=!!document.pointerLockElement,Object.assign(s,An(e)),s.down=s.pressed=s.buttons%2===1||s.touches>0,a=e.timeStamp-o.timeStamp,o.timeStamp=e.timeStamp,o.elapsedTime=o.timeStamp-o.startTime),o._active){const p=o._delta.map(Math.abs);j.addTo(o._distance,p)}this.axisIntent&&this.axisIntent(e);const[f,r]=o._movement,[l,d]=t.threshold,{_step:u,values:h}=o;if(t.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(f)>=l&&h[0]),u[1]===!1&&(u[1]=Math.abs(r)>=d&&h[1])):(u[0]===!1&&(u[0]=Math.abs(f)>=l&&Math.sign(f)*l),u[1]===!1&&(u[1]=Math.abs(r)>=d&&Math.sign(r)*d)),o.intentional=u[0]!==!1||u[1]!==!1,!o.intentional)return;const b=[0,0];if(t.hasCustomTransform){const[p,U]=h;b[0]=u[0]!==!1?p-u[0]:0,b[1]=u[1]!==!1?U-u[1]:0}else b[0]=u[0]!==!1?f-u[0]:0,b[1]=u[1]!==!1?r-u[1]:0;this.restrictToAxis&&!o._blocked&&this.restrictToAxis(b);const x=o.offset,P=o._active&&!o._blocked||o.active;P&&(o.first=o._active&&!o.active,o.last=!o._active&&o.active,o.active=s[this.ingKey]=o._active,e&&(o.first&&("bounds"in t&&(o._bounds=ge(t.bounds,o)),this.setup&&this.setup()),o.movement=b,this.computeOffset()));const[w,M]=o.offset,[[T,v],[E,I]]=o._bounds;o.overflow=[w<T?-1:w>v?1:0,M<E?-1:M>I?1:0],o._movementBound[0]=o.overflow[0]?o._movementBound[0]===!1?o._movement[0]:o._movementBound[0]:!1,o._movementBound[1]=o.overflow[1]?o._movementBound[1]===!1?o._movement[1]:o._movementBound[1]:!1;const O=o._active?t.rubberband||[0,0]:[0,0];if(o.offset=yn(o._bounds,o.offset,O),o.delta=j.sub(o.offset,x),this.computeMovement(),P&&(!o.last||a>In)){o.delta=j.sub(o.offset,x);const p=o.delta.map(Math.abs);j.addTo(o.distance,p),o.direction=o.delta.map(Math.sign),o._direction=o._delta.map(Math.sign),!o.first&&a>0&&(o.velocity=[p[0]/a,p[1]/a],o.timeDelta=a)}}emit(){const e=this.state,o=this.shared,t=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!t.triggerAllEvents)return;const s=this.handler(D(D(D({},o),e),{},{[this.aliasKey]:e.values}));s!==void 0&&(e.memo=s)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function Ln([n,e],o){const t=Math.abs(n),s=Math.abs(e);if(t>s&&t>o)return"x";if(s>t&&s>o)return"y"}class Rn extends kn{constructor(...e){super(...e),N(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=j.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=j.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const o=this.state,t=this.config;if(!o.axis&&e){const s=typeof t.axisThreshold=="object"?t.axisThreshold[Ot(e)]:t.axisThreshold;o.axis=Ln(o._movement,s)}o._blocked=(t.lockDirection||!!t.axis)&&!o.axis||!!t.axis&&t.axis!==o.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const jn=n=>n,lt=.15,Mt={enabled(n=!0){return n},eventOptions(n,e,o){return D(D({},o.shared.eventOptions),n)},preventDefault(n=!1){return n},triggerAllEvents(n=!1){return n},rubberband(n=0){switch(n){case!0:return[lt,lt];case!1:return[0,0];default:return j.toVector(n)}},from(n){if(typeof n=="function")return n;if(n!=null)return j.toVector(n)},transform(n,e,o){const t=n||o.shared.transform;return this.hasCustomTransform=!!t,t||jn},threshold(n){return j.toVector(n,0)}},Un=0,ie=D(D({},Mt),{},{axis(n,e,{axis:o}){if(this.lockDirection=o==="lock",!this.lockDirection)return o},axisThreshold(n=Un){return n},bounds(n={}){if(typeof n=="function")return a=>ie.bounds(n(a));if("current"in n)return()=>n.current;if(typeof HTMLElement=="function"&&n instanceof HTMLElement)return n;const{left:e=-1/0,right:o=1/0,top:t=-1/0,bottom:s=1/0}=n;return[[e,o],[t,s]]}}),ut={ArrowRight:(n,e=1)=>[n*e,0],ArrowLeft:(n,e=1)=>[-1*n*e,0],ArrowUp:(n,e=1)=>[0,-1*n*e],ArrowDown:(n,e=1)=>[0,n*e]};class Nn extends Rn{constructor(...e){super(...e),N(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const o=e._bounds.getBoundingClientRect(),t=e.currentTarget.getBoundingClientRect(),s={left:o.left-t.left+e.offset[0],right:o.right-t.right+e.offset[0],top:o.top-t.top+e.offset[1],bottom:o.bottom-t.bottom+e.offset[1]};e._bounds=ie.bounds(s)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const o=this.config,t=this.state;if(e.buttons!=null&&(Array.isArray(o.pointerButtons)?!o.pointerButtons.includes(e.buttons):o.pointerButtons!==-1&&o.pointerButtons!==e.buttons))return;const s=this.ctrl.setEventIds(e);o.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(s&&s.size>1&&t._pointerActive)&&(this.start(e),this.setupPointer(e),t._pointerId=xe(e),t._pointerActive=!0,this.computeValues(at(e)),this.computeInitial(),o.preventScrollAxis&&Ot(e)!=="mouse"?(t._active=!1,this.setupScrollPrevention(e)):o.delay>0?(this.setupDelayTrigger(e),o.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const o=this.state;o._active=!0,o._preventScroll=!0,o._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const o=this.state,t=this.config;if(!o._pointerActive)return;const s=xe(e);if(o._pointerId!==void 0&&s!==o._pointerId)return;const a=at(e);if(document.pointerLockElement===e.target?o._delta=[e.movementX,e.movementY]:(o._delta=j.sub(a,o._values),this.computeValues(a)),j.addTo(o._movement,o._delta),this.compute(e),o._delayed&&o.intentional){this.timeoutStore.remove("dragDelay"),o.active=!1,this.startPointerDrag(e);return}if(t.preventScrollAxis&&!o._preventScroll)if(o.axis)if(o.axis===t.preventScrollAxis||t.preventScrollAxis==="xy"){o._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const o=this.state,t=this.config;if(!o._active||!o._pointerActive)return;const s=xe(e);if(o._pointerId!==void 0&&s!==o._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[a,f]=o._distance;if(o.tap=a<=t.tapsThreshold&&f<=t.tapsThreshold,o.tap&&t.filterTaps)o._force=!0;else{const[r,l]=o._delta,[d,u]=o._movement,[h,b]=t.swipe.velocity,[x,P]=t.swipe.distance,w=t.swipe.duration;if(o.elapsedTime<w){const M=Math.abs(r/o.timeDelta),T=Math.abs(l/o.timeDelta);M>h&&Math.abs(d)>x&&(o.swipe[0]=Math.sign(r)),T>b&&Math.abs(u)>P&&(o.swipe[1]=Math.sign(l))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const o=this.config,t=o.device;o.pointerLock&&e.currentTarget.requestPointerLock(),o.pointerCapture||(this.eventStore.add(this.sharedConfig.window,t,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,t,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,t,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,zn(e);const o=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",o),this.eventStore.add(this.sharedConfig.window,"touch","cancel",o),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const o=ut[e.key];if(o){const t=this.state,s=e.shiftKey?10:e.altKey?.1:1;this.start(e),t._delta=o(this.config.keyboardDisplacement,s),t._keyboardActive=!0,j.addTo(t._movement,t._delta),this.compute(e),this.emit()}}keyUp(e){e.key in ut&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const o=this.config.device;e(o,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(o,"change",this.pointerMove.bind(this)),e(o,"end",this.pointerUp.bind(this)),e(o,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function zn(n){"persist"in n&&typeof n.persist=="function"&&n.persist()}const se=typeof window<"u"&&window.document&&window.document.createElement;function At(){return se&&"ontouchstart"in window}function Fn(){return At()||se&&window.navigator.maxTouchPoints>1}function Kn(){return se&&"onpointerdown"in window}function Yn(){return se&&"exitPointerLock"in window.document}function Bn(){try{return"constructor"in GestureEvent}catch{return!1}}const z={isBrowser:se,gesture:Bn(),touch:At(),touchscreen:Fn(),pointer:Kn(),pointerLock:Yn()},Vn=250,Hn=180,Wn=.5,Xn=50,Zn=250,Gn=10,ft={mouse:0,touch:0,pen:8},$n=D(D({},ie),{},{device(n,e,{pointer:{touch:o=!1,lock:t=!1,mouse:s=!1}={}}){return this.pointerLock=t&&z.pointerLock,z.touch&&o?"touch":this.pointerLock?"mouse":z.pointer&&!s?"pointer":z.touch?"touch":"mouse"},preventScrollAxis(n,e,{preventScroll:o}){if(this.preventScrollDelay=typeof o=="number"?o:o||o===void 0&&n?Vn:void 0,!(!z.touchscreen||o===!1))return n||(o!==void 0?"y":void 0)},pointerCapture(n,e,{pointer:{capture:o=!0,buttons:t=1,keys:s=!0}={}}){return this.pointerButtons=t,this.keys=s,!this.pointerLock&&this.device==="pointer"&&o},threshold(n,e,{filterTaps:o=!1,tapsThreshold:t=3,axis:s=void 0}){const a=j.toVector(n,o?t:s?1:0);return this.filterTaps=o,this.tapsThreshold=t,a},swipe({velocity:n=Wn,distance:e=Xn,duration:o=Zn}={}){return{velocity:this.transform(j.toVector(n)),distance:this.transform(j.toVector(e)),duration:o}},delay(n=0){switch(n){case!0:return Hn;case!1:return 0;default:return n}},axisThreshold(n){return n?D(D({},ft),n):ft},keyboardDisplacement(n=Gn){return n}});D(D({},Mt),{},{device(n,e,{shared:o,pointer:{touch:t=!1}={}}){if(o.target&&!z.touch&&z.gesture)return"gesture";if(z.touch&&t)return"touch";if(z.touchscreen){if(z.pointer)return"pointer";if(z.touch)return"touch"}},bounds(n,e,{scaleBounds:o={},angleBounds:t={}}){const s=f=>{const r=ct(ge(o,f),{min:-1/0,max:1/0});return[r.min,r.max]},a=f=>{const r=ct(ge(t,f),{min:-1/0,max:1/0});return[r.min,r.max]};return typeof o!="function"&&typeof t!="function"?[s(),a()]:f=>[s(f),a(f)]},threshold(n,e,o){return this.lockDirection=o.axis==="lock",j.toVector(n,this.lockDirection?[.1,3]:0)},modifierKey(n){return n===void 0?"ctrlKey":n},pinchOnWheel(n=!0){return n}});D(D({},ie),{},{mouseOnly:(n=!0)=>n});D(D({},ie),{},{mouseOnly:(n=!0)=>n});const Dt=new Map,Me=new Map;function qn(n){Dt.set(n.key,n.engine),Me.set(n.key,n.resolver)}const Qn={key:"drag",engine:Nn,resolver:$n};function Jn(n,e){if(n==null)return{};var o={},t=Object.keys(n),s,a;for(a=0;a<t.length;a++)s=t[a],!(e.indexOf(s)>=0)&&(o[s]=n[s]);return o}function eo(n,e){if(n==null)return{};var o=Jn(n,e),t,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(s=0;s<a.length;s++)t=a[s],!(e.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(n,t)&&(o[t]=n[t])}return o}const to={target(n){if(n)return()=>"current"in n?n.current:n},enabled(n=!0){return n},window(n=z.isBrowser?window:void 0){return n},eventOptions({passive:n=!0,capture:e=!1}={}){return{passive:n,capture:e}},transform(n){return n}},no=["target","eventOptions","window","enabled","transform"];function pe(n={},e){const o={};for(const[t,s]of Object.entries(e))switch(typeof s){case"function":o[t]=s.call(o,n[t],t,n);break;case"object":o[t]=pe(n[t],s);break;case"boolean":s&&(o[t]=n[t]);break}return o}function oo(n,e,o={}){const t=n,{target:s,eventOptions:a,window:f,enabled:r,transform:l}=t,d=eo(t,no);if(o.shared=pe({target:s,eventOptions:a,window:f,enabled:r,transform:l},to),e){const u=Me.get(e);o[e]=pe(D({shared:o.shared},d),u)}else for(const u in d){const h=Me.get(u);h&&(o[u]=pe(D({shared:o.shared},d[u]),h))}return o}class Ct{constructor(e,o){N(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=o}add(e,o,t,s,a){const f=this._listeners,r=xn(o,t),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},d=D(D({},l),a);e.addEventListener(r,s,d);const u=()=>{e.removeEventListener(r,s,d),f.delete(u)};return f.add(u),u}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class io{constructor(){N(this,"_timeouts",new Map)}add(e,o,t=140,...s){this.remove(e),this._timeouts.set(e,window.setTimeout(o,t,...s))}remove(e){const o=this._timeouts.get(e);o&&window.clearTimeout(o)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class so{constructor(e){N(this,"gestures",new Set),N(this,"_targetEventStore",new Ct(this)),N(this,"gestureEventStores",{}),N(this,"gestureTimeoutStores",{}),N(this,"handlers",{}),N(this,"config",{}),N(this,"pointerIds",new Set),N(this,"touchIds",new Set),N(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),ro(this,e)}setEventIds(e){if(ye(e))return this.touchIds=new Set(Mn(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,o){this.handlers=e,this.nativeHandlers=o}applyConfig(e,o){this.config=oo(e,o,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const o=this.config.shared,t={};let s;if(!(o.target&&(s=o.target(),!s))){if(o.enabled){for(const f of this.gestures){const r=this.config[f],l=ht(t,r.eventOptions,!!s);if(r.enabled){const d=Dt.get(f);new d(this,e,f).bind(l)}}const a=ht(t,o.eventOptions,!!s);for(const f in this.nativeHandlers)a(f,"",r=>this.nativeHandlers[f](D(D({},this.state.shared),{},{event:r,args:e})),void 0,!0)}for(const a in t)t[a]=Cn(...t[a]);if(!s)return t;for(const a in t){const{device:f,capture:r,passive:l}=Pn(a);this._targetEventStore.add(s,f,"",t[a],{capture:r,passive:l})}}}}function q(n,e){n.gestures.add(e),n.gestureEventStores[e]=new Ct(n,e),n.gestureTimeoutStores[e]=new io}function ro(n,e){e.drag&&q(n,"drag"),e.wheel&&q(n,"wheel"),e.scroll&&q(n,"scroll"),e.move&&q(n,"move"),e.pinch&&q(n,"pinch"),e.hover&&q(n,"hover")}const ht=(n,e,o)=>(t,s,a,f={},r=!1)=>{var l,d;const u=(l=f.capture)!==null&&l!==void 0?l:e.capture,h=(d=f.passive)!==null&&d!==void 0?d:e.passive;let b=r?t:wn(t,s,u);o&&h&&(b+="Passive"),n[b]=n[b]||[],n[b].push(a)};function ao(n,e={},o,t){const s=Pe.useMemo(()=>new so(n),[]);if(s.applyHandlers(n,t),s.applyConfig(e,o),Pe.useEffect(s.effect.bind(s)),Pe.useEffect(()=>s.clean.bind(s),[]),e.target===void 0)return s.bind.bind(s)}function Lo(n,e){return qn(Qn),ao({drag:n},e||{},"drag")}const co=n=>(e,o,t)=>{const s=t.subscribe;return t.subscribe=(f,r,l)=>{let d=f;if(r){const u=(l==null?void 0:l.equalityFn)||Object.is;let h=f(t.getState());d=b=>{const x=f(b);if(!u(h,x)){const P=h;r(h=x,P)}},l!=null&&l.fireImmediately&&r(h,h)}return s(d)},n(e,o,t)},It=m.createContext(null);function Ro({map:n,children:e,onChange:o,domElement:t}){const s=n.map(l=>l.name+l.keys).join("-"),a=m.useMemo(()=>on(co(()=>n.reduce((l,d)=>({...l,[d.name]:!1}),{}))),[s]),f=m.useMemo(()=>[a.subscribe,a.getState,a],[s]),r=a.setState;return m.useEffect(()=>{const d=n.map(({name:x,keys:P,up:w})=>({keys:P,up:w,fn:M=>{r({[x]:M}),o&&o(x,M,f[1]())}})).reduce((x,{keys:P,fn:w,up:M=!0})=>(P.forEach(T=>x[T]={fn:w,pressed:!1,up:M}),x),{}),u=({key:x,code:P})=>{const w=d[x]||d[P];if(!w)return;const{fn:M,pressed:T,up:v}=w;w.pressed=!0,(v||!T)&&M(!0)},h=({key:x,code:P})=>{const w=d[x]||d[P];if(!w)return;const{fn:M,up:T}=w;w.pressed=!1,T&&M(!1)},b=t||window;return b.addEventListener("keydown",u,{passive:!0}),b.addEventListener("keyup",h,{passive:!0}),()=>{b.removeEventListener("keydown",u),b.removeEventListener("keyup",h)}},[t,s]),m.createElement(It.Provider,{value:f,children:e})}function jo(n){const[e,o,t]=m.useContext(It);return[e,o]}const lo=parseInt(_t.replace(/\D+/g,""));var uo=Object.defineProperty,fo=(n,e,o)=>e in n?uo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,kt=(n,e,o)=>(fo(n,typeof e!="symbol"?e+"":e,o),o);const me={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new C},up:{value:new C(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${lo>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},Lt=new wt({name:"SkyShader",fragmentShader:me.fragmentShader,vertexShader:me.vertexShader,uniforms:Tt.clone(me.uniforms),side:an,depthWrite:!1});let Ce=class extends cn{constructor(){super(new ln(1,1,1),Lt)}};kt(Ce,"SkyShader",me);kt(Ce,"material",Lt);var ho=Object.defineProperty,po=(n,e,o)=>e in n?ho(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,g=(n,e,o)=>(po(n,typeof e!="symbol"?e+"":e,o),o);const ue=new un,dt=new fn,mo=Math.cos(70*(Math.PI/180)),pt=(n,e)=>(n%e+e)%e;let go=class extends hn{constructor(e,o){super(),g(this,"object"),g(this,"domElement"),g(this,"enabled",!0),g(this,"target",new C),g(this,"minDistance",0),g(this,"maxDistance",1/0),g(this,"minZoom",0),g(this,"maxZoom",1/0),g(this,"minPolarAngle",0),g(this,"maxPolarAngle",Math.PI),g(this,"minAzimuthAngle",-1/0),g(this,"maxAzimuthAngle",1/0),g(this,"enableDamping",!1),g(this,"dampingFactor",.05),g(this,"enableZoom",!0),g(this,"zoomSpeed",1),g(this,"enableRotate",!0),g(this,"rotateSpeed",1),g(this,"enablePan",!0),g(this,"panSpeed",1),g(this,"screenSpacePanning",!0),g(this,"keyPanSpeed",7),g(this,"zoomToCursor",!1),g(this,"autoRotate",!1),g(this,"autoRotateSpeed",2),g(this,"reverseOrbit",!1),g(this,"reverseHorizontalOrbit",!1),g(this,"reverseVerticalOrbit",!1),g(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),g(this,"mouseButtons",{LEFT:G.ROTATE,MIDDLE:G.DOLLY,RIGHT:G.PAN}),g(this,"touches",{ONE:$.ROTATE,TWO:$.DOLLY_PAN}),g(this,"target0"),g(this,"position0"),g(this,"zoom0"),g(this,"_domElementKeyEvents",null),g(this,"getPolarAngle"),g(this,"getAzimuthalAngle"),g(this,"setPolarAngle"),g(this,"setAzimuthalAngle"),g(this,"getDistance"),g(this,"listenToKeyEvents"),g(this,"stopListenToKeyEvents"),g(this,"saveState"),g(this,"reset"),g(this,"update"),g(this,"connect"),g(this,"dispose"),this.object=e,this.domElement=o,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=i=>{let c=pt(i,2*Math.PI),y=u.phi;y<0&&(y+=2*Math.PI),c<0&&(c+=2*Math.PI);let S=Math.abs(c-y);2*Math.PI-S<S&&(c<y?c+=2*Math.PI:y+=2*Math.PI),h.phi=c-y,t.update()},this.setAzimuthalAngle=i=>{let c=pt(i,2*Math.PI),y=u.theta;y<0&&(y+=2*Math.PI),c<0&&(c+=2*Math.PI);let S=Math.abs(c-y);2*Math.PI-S<S&&(c<y?c+=2*Math.PI:y+=2*Math.PI),h.theta=c-y,t.update()},this.getDistance=()=>t.object.position.distanceTo(t.target),this.listenToKeyEvents=i=>{i.addEventListener("keydown",we),this._domElementKeyEvents=i},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",we),this._domElementKeyEvents=null},this.saveState=()=>{t.target0.copy(t.target),t.position0.copy(t.object.position),t.zoom0=t.object.zoom},this.reset=()=>{t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),t.dispatchEvent(s),t.update(),l=r.NONE},this.update=(()=>{const i=new C,c=new C(0,1,0),y=new oe().setFromUnitVectors(e.up,c),S=y.clone().invert(),L=new C,K=new oe,H=2*Math.PI;return function(){const qe=t.object.position;y.setFromUnitVectors(e.up,c),S.copy(y).invert(),i.copy(qe).sub(t.target),i.applyQuaternion(y),u.setFromVector3(i),t.autoRotate&&l===r.NONE&&be(Nt()),t.enableDamping?(u.theta+=h.theta*t.dampingFactor,u.phi+=h.phi*t.dampingFactor):(u.theta+=h.theta,u.phi+=h.phi);let Y=t.minAzimuthAngle,B=t.maxAzimuthAngle;isFinite(Y)&&isFinite(B)&&(Y<-Math.PI?Y+=H:Y>Math.PI&&(Y-=H),B<-Math.PI?B+=H:B>Math.PI&&(B-=H),Y<=B?u.theta=Math.max(Y,Math.min(B,u.theta)):u.theta=u.theta>(Y+B)/2?Math.max(Y,u.theta):Math.min(B,u.theta)),u.phi=Math.max(t.minPolarAngle,Math.min(t.maxPolarAngle,u.phi)),u.makeSafe(),t.enableDamping===!0?t.target.addScaledVector(x,t.dampingFactor):t.target.add(x),t.zoomToCursor&&k||t.object.isOrthographicCamera?u.radius=Ee(u.radius):u.radius=Ee(u.radius*b),i.setFromSpherical(u),i.applyQuaternion(S),qe.copy(t.target).add(i),t.object.matrixAutoUpdate||t.object.updateMatrix(),t.object.lookAt(t.target),t.enableDamping===!0?(h.theta*=1-t.dampingFactor,h.phi*=1-t.dampingFactor,x.multiplyScalar(1-t.dampingFactor)):(h.set(0,0,0),x.set(0,0,0));let J=!1;if(t.zoomToCursor&&k){let ee=null;if(t.object instanceof ce&&t.object.isPerspectiveCamera){const te=i.length();ee=Ee(te*b);const ae=te-ee;t.object.position.addScaledVector(U,ae),t.object.updateMatrixWorld()}else if(t.object.isOrthographicCamera){const te=new C(A.x,A.y,0);te.unproject(t.object),t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/b)),t.object.updateProjectionMatrix(),J=!0;const ae=new C(A.x,A.y,0);ae.unproject(t.object),t.object.position.sub(ae).add(te),t.object.updateMatrixWorld(),ee=i.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),t.zoomToCursor=!1;ee!==null&&(t.screenSpacePanning?t.target.set(0,0,-1).transformDirection(t.object.matrix).multiplyScalar(ee).add(t.object.position):(ue.origin.copy(t.object.position),ue.direction.set(0,0,-1).transformDirection(t.object.matrix),Math.abs(t.object.up.dot(ue.direction))<mo?e.lookAt(t.target):(dt.setFromNormalAndCoplanarPoint(t.object.up,t.target),ue.intersectPlane(dt,t.target))))}else t.object instanceof le&&t.object.isOrthographicCamera&&(J=b!==1,J&&(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/b)),t.object.updateProjectionMatrix()));return b=1,k=!1,J||L.distanceToSquared(t.object.position)>d||8*(1-K.dot(t.object.quaternion))>d?(t.dispatchEvent(s),L.copy(t.object.position),K.copy(t.object.quaternion),J=!1,!0):!1}})(),this.connect=i=>{i===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),t.domElement=i,t.domElement.style.touchAction="none",t.domElement.addEventListener("contextmenu",Ge),t.domElement.addEventListener("pointerdown",Xe),t.domElement.addEventListener("pointercancel",Q),t.domElement.addEventListener("wheel",Ze)},this.dispose=()=>{var i,c,y,S,L,K;t.domElement&&(t.domElement.style.touchAction="auto"),(i=t.domElement)==null||i.removeEventListener("contextmenu",Ge),(c=t.domElement)==null||c.removeEventListener("pointerdown",Xe),(y=t.domElement)==null||y.removeEventListener("pointercancel",Q),(S=t.domElement)==null||S.removeEventListener("wheel",Ze),(L=t.domElement)==null||L.ownerDocument.removeEventListener("pointermove",_e),(K=t.domElement)==null||K.ownerDocument.removeEventListener("pointerup",Q),t._domElementKeyEvents!==null&&t._domElementKeyEvents.removeEventListener("keydown",we)};const t=this,s={type:"change"},a={type:"start"},f={type:"end"},r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=r.NONE;const d=1e-6,u=new Qe,h=new Qe;let b=1;const x=new C,P=new F,w=new F,M=new F,T=new F,v=new F,E=new F,I=new F,O=new F,p=new F,U=new C,A=new F;let k=!1;const _=[],X={};function Nt(){return 2*Math.PI/60/60*t.autoRotateSpeed}function re(){return Math.pow(.95,t.zoomSpeed)}function be(i){t.reverseOrbit||t.reverseHorizontalOrbit?h.theta+=i:h.theta-=i}function Le(i){t.reverseOrbit||t.reverseVerticalOrbit?h.phi+=i:h.phi-=i}const Re=(()=>{const i=new C;return function(y,S){i.setFromMatrixColumn(S,0),i.multiplyScalar(-y),x.add(i)}})(),je=(()=>{const i=new C;return function(y,S){t.screenSpacePanning===!0?i.setFromMatrixColumn(S,1):(i.setFromMatrixColumn(S,0),i.crossVectors(t.object.up,i)),i.multiplyScalar(y),x.add(i)}})(),Z=(()=>{const i=new C;return function(y,S){const L=t.domElement;if(L&&t.object instanceof ce&&t.object.isPerspectiveCamera){const K=t.object.position;i.copy(K).sub(t.target);let H=i.length();H*=Math.tan(t.object.fov/2*Math.PI/180),Re(2*y*H/L.clientHeight,t.object.matrix),je(2*S*H/L.clientHeight,t.object.matrix)}else L&&t.object instanceof le&&t.object.isOrthographicCamera?(Re(y*(t.object.right-t.object.left)/t.object.zoom/L.clientWidth,t.object.matrix),je(S*(t.object.top-t.object.bottom)/t.object.zoom/L.clientHeight,t.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),t.enablePan=!1)}})();function ve(i){t.object instanceof ce&&t.object.isPerspectiveCamera||t.object instanceof le&&t.object.isOrthographicCamera?b/=i:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function Ue(i){t.object instanceof ce&&t.object.isPerspectiveCamera||t.object instanceof le&&t.object.isOrthographicCamera?b*=i:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function Ne(i){if(!t.zoomToCursor||!t.domElement)return;k=!0;const c=t.domElement.getBoundingClientRect(),y=i.clientX-c.left,S=i.clientY-c.top,L=c.width,K=c.height;A.x=y/L*2-1,A.y=-(S/K)*2+1,U.set(A.x,A.y,1).unproject(t.object).sub(t.object.position).normalize()}function Ee(i){return Math.max(t.minDistance,Math.min(t.maxDistance,i))}function ze(i){P.set(i.clientX,i.clientY)}function zt(i){Ne(i),I.set(i.clientX,i.clientY)}function Fe(i){T.set(i.clientX,i.clientY)}function Ft(i){w.set(i.clientX,i.clientY),M.subVectors(w,P).multiplyScalar(t.rotateSpeed);const c=t.domElement;c&&(be(2*Math.PI*M.x/c.clientHeight),Le(2*Math.PI*M.y/c.clientHeight)),P.copy(w),t.update()}function Kt(i){O.set(i.clientX,i.clientY),p.subVectors(O,I),p.y>0?ve(re()):p.y<0&&Ue(re()),I.copy(O),t.update()}function Yt(i){v.set(i.clientX,i.clientY),E.subVectors(v,T).multiplyScalar(t.panSpeed),Z(E.x,E.y),T.copy(v),t.update()}function Bt(i){Ne(i),i.deltaY<0?Ue(re()):i.deltaY>0&&ve(re()),t.update()}function Vt(i){let c=!1;switch(i.code){case t.keys.UP:Z(0,t.keyPanSpeed),c=!0;break;case t.keys.BOTTOM:Z(0,-t.keyPanSpeed),c=!0;break;case t.keys.LEFT:Z(t.keyPanSpeed,0),c=!0;break;case t.keys.RIGHT:Z(-t.keyPanSpeed,0),c=!0;break}c&&(i.preventDefault(),t.update())}function Ke(){if(_.length==1)P.set(_[0].pageX,_[0].pageY);else{const i=.5*(_[0].pageX+_[1].pageX),c=.5*(_[0].pageY+_[1].pageY);P.set(i,c)}}function Ye(){if(_.length==1)T.set(_[0].pageX,_[0].pageY);else{const i=.5*(_[0].pageX+_[1].pageX),c=.5*(_[0].pageY+_[1].pageY);T.set(i,c)}}function Be(){const i=_[0].pageX-_[1].pageX,c=_[0].pageY-_[1].pageY,y=Math.sqrt(i*i+c*c);I.set(0,y)}function Ht(){t.enableZoom&&Be(),t.enablePan&&Ye()}function Wt(){t.enableZoom&&Be(),t.enableRotate&&Ke()}function Ve(i){if(_.length==1)w.set(i.pageX,i.pageY);else{const y=Te(i),S=.5*(i.pageX+y.x),L=.5*(i.pageY+y.y);w.set(S,L)}M.subVectors(w,P).multiplyScalar(t.rotateSpeed);const c=t.domElement;c&&(be(2*Math.PI*M.x/c.clientHeight),Le(2*Math.PI*M.y/c.clientHeight)),P.copy(w)}function He(i){if(_.length==1)v.set(i.pageX,i.pageY);else{const c=Te(i),y=.5*(i.pageX+c.x),S=.5*(i.pageY+c.y);v.set(y,S)}E.subVectors(v,T).multiplyScalar(t.panSpeed),Z(E.x,E.y),T.copy(v)}function We(i){const c=Te(i),y=i.pageX-c.x,S=i.pageY-c.y,L=Math.sqrt(y*y+S*S);O.set(0,L),p.set(0,Math.pow(O.y/I.y,t.zoomSpeed)),ve(p.y),I.copy(O)}function Xt(i){t.enableZoom&&We(i),t.enablePan&&He(i)}function Zt(i){t.enableZoom&&We(i),t.enableRotate&&Ve(i)}function Xe(i){var c,y;t.enabled!==!1&&(_.length===0&&((c=t.domElement)==null||c.ownerDocument.addEventListener("pointermove",_e),(y=t.domElement)==null||y.ownerDocument.addEventListener("pointerup",Q)),Jt(i),i.pointerType==="touch"?qt(i):Gt(i))}function _e(i){t.enabled!==!1&&(i.pointerType==="touch"?Qt(i):$t(i))}function Q(i){var c,y,S;en(i),_.length===0&&((c=t.domElement)==null||c.releasePointerCapture(i.pointerId),(y=t.domElement)==null||y.ownerDocument.removeEventListener("pointermove",_e),(S=t.domElement)==null||S.ownerDocument.removeEventListener("pointerup",Q)),t.dispatchEvent(f),l=r.NONE}function Gt(i){let c;switch(i.button){case 0:c=t.mouseButtons.LEFT;break;case 1:c=t.mouseButtons.MIDDLE;break;case 2:c=t.mouseButtons.RIGHT;break;default:c=-1}switch(c){case G.DOLLY:if(t.enableZoom===!1)return;zt(i),l=r.DOLLY;break;case G.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(t.enablePan===!1)return;Fe(i),l=r.PAN}else{if(t.enableRotate===!1)return;ze(i),l=r.ROTATE}break;case G.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(t.enableRotate===!1)return;ze(i),l=r.ROTATE}else{if(t.enablePan===!1)return;Fe(i),l=r.PAN}break;default:l=r.NONE}l!==r.NONE&&t.dispatchEvent(a)}function $t(i){if(t.enabled!==!1)switch(l){case r.ROTATE:if(t.enableRotate===!1)return;Ft(i);break;case r.DOLLY:if(t.enableZoom===!1)return;Kt(i);break;case r.PAN:if(t.enablePan===!1)return;Yt(i);break}}function Ze(i){t.enabled===!1||t.enableZoom===!1||l!==r.NONE&&l!==r.ROTATE||(i.preventDefault(),t.dispatchEvent(a),Bt(i),t.dispatchEvent(f))}function we(i){t.enabled===!1||t.enablePan===!1||Vt(i)}function qt(i){switch($e(i),_.length){case 1:switch(t.touches.ONE){case $.ROTATE:if(t.enableRotate===!1)return;Ke(),l=r.TOUCH_ROTATE;break;case $.PAN:if(t.enablePan===!1)return;Ye(),l=r.TOUCH_PAN;break;default:l=r.NONE}break;case 2:switch(t.touches.TWO){case $.DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;Ht(),l=r.TOUCH_DOLLY_PAN;break;case $.DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;Wt(),l=r.TOUCH_DOLLY_ROTATE;break;default:l=r.NONE}break;default:l=r.NONE}l!==r.NONE&&t.dispatchEvent(a)}function Qt(i){switch($e(i),l){case r.TOUCH_ROTATE:if(t.enableRotate===!1)return;Ve(i),t.update();break;case r.TOUCH_PAN:if(t.enablePan===!1)return;He(i),t.update();break;case r.TOUCH_DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;Xt(i),t.update();break;case r.TOUCH_DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;Zt(i),t.update();break;default:l=r.NONE}}function Ge(i){t.enabled!==!1&&i.preventDefault()}function Jt(i){_.push(i)}function en(i){delete X[i.pointerId];for(let c=0;c<_.length;c++)if(_[c].pointerId==i.pointerId){_.splice(c,1);return}}function $e(i){let c=X[i.pointerId];c===void 0&&(c=new F,X[i.pointerId]=c),c.set(i.pageX,i.pageY)}function Te(i){const c=i.pointerId===_[0].pointerId?_[1]:_[0];return X[c.pointerId]}o!==void 0&&this.connect(o),this.update()}};function zo(n,e){if(Object.is(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;const o=Object.keys(n);if(o.length!==Object.keys(e).length)return!1;for(let t=0;t<o.length;t++)if(!Object.prototype.hasOwnProperty.call(e,o[t])||!Object.is(n[o[t]],e[o[t]]))return!1;return!0}function Ko(n,e,o,t){const s=class extends wt{constructor(f={}){const r=Object.entries(n);super({uniforms:r.reduce((l,[d,u])=>{const h=Tt.clone({[d]:{value:u}});return{...l,...h}},{}),vertexShader:e,fragmentShader:o}),this.key="",r.forEach(([l])=>Object.defineProperty(this,l,{get:()=>this.uniforms[l].value,set:d=>this.uniforms[l].value=d})),Object.assign(this,f)}};return s.key=dn.generateUUID(),s}const Oe=n=>n===Object(n)&&!Array.isArray(n)&&typeof n!="function";function Ie(n,e){const o=V(a=>a.gl),t=Ae(De,Oe(n)?Object.values(n):n);return m.useLayoutEffect(()=>{e==null||e(t)},[e]),m.useEffect(()=>{if("initTexture"in o){let a=[];Array.isArray(t)?a=t:t instanceof Je?a=[t]:Oe(t)&&(a=Object.values(t)),a.forEach(f=>{f instanceof Je&&o.initTexture(f)})}},[o,t]),m.useMemo(()=>{if(Oe(n)){const a={};let f=0;for(const r in n)a[r]=t[f++];return console.log("keyed",a),a}else return t},[n,t])}Ie.preload=n=>Ae.preload(De,n);Ie.clear=n=>Ae.clear(De,n);const Yo=m.forwardRef(({makeDefault:n,camera:e,regress:o,domElement:t,enableDamping:s=!0,keyEvents:a=!1,onChange:f,onStart:r,onEnd:l,...d},u)=>{const h=V(p=>p.invalidate),b=V(p=>p.camera),x=V(p=>p.gl),P=V(p=>p.events),w=V(p=>p.setEvents),M=V(p=>p.set),T=V(p=>p.get),v=V(p=>p.performance),E=e||b,I=t||P.connected||x.domElement,O=m.useMemo(()=>new go(E),[E]);return Et(()=>{O.enabled&&O.update()},-1),m.useEffect(()=>(a&&O.connect(a===!0?I:a),O.connect(I),()=>void O.dispose()),[a,I,o,O,h]),m.useEffect(()=>{const p=k=>{h(),o&&v.regress(),f&&f(k)},U=k=>{r&&r(k)},A=k=>{l&&l(k)};return O.addEventListener("change",p),O.addEventListener("start",U),O.addEventListener("end",A),()=>{O.removeEventListener("start",U),O.removeEventListener("end",A),O.removeEventListener("change",p)}},[f,r,l,O,h,w]),m.useEffect(()=>{if(n){const p=T().controls;return M({controls:O}),()=>M({controls:p})}},[n,O]),m.createElement("primitive",W({ref:u,object:O,enableDamping:s},d))});var Rt={exports:{}},yo="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",bo=yo,vo=bo;function jt(){}function Ut(){}Ut.resetWarningCache=jt;var Eo=function(){function n(t,s,a,f,r,l){if(l!==vo){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}n.isRequired=n;function e(){return n}var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Ut,resetWarningCache:jt};return o.PropTypes=o,o};Rt.exports=Eo();var _o=Rt.exports;const Bo=nn(_o),Se=(n,e)=>{"updateRanges"in n?n.updateRanges[0]=e:n.updateRange=e};function wo(n,e,o=new C){const t=Math.PI*(n-.5),s=2*Math.PI*(e-.5);return o.x=Math.cos(s),o.y=Math.sin(t),o.z=Math.sin(s),o}const Vo=m.forwardRef(({inclination:n=.6,azimuth:e=.1,distance:o=1e3,mieCoefficient:t=.005,mieDirectionalG:s=.8,rayleigh:a=.5,turbidity:f=10,sunPosition:r=wo(n,e),...l},d)=>{const u=m.useMemo(()=>new C().setScalar(o),[o]),[h]=m.useState(()=>new Ce);return m.createElement("primitive",W({object:h,ref:d,"material-uniforms-mieCoefficient-value":t,"material-uniforms-mieDirectionalG-value":s,"material-uniforms-rayleigh-value":a,"material-uniforms-sunPosition-value":r,"material-uniforms-turbidity-value":f,scale:u},l))});let fe;const To=new Uint8Array(16);function Po(){if(!fe&&(fe=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!fe))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return fe(To)}const R=[];for(let n=0;n<256;++n)R.push((n+256).toString(16).slice(1));function xo(n,e=0){return R[n[e+0]]+R[n[e+1]]+R[n[e+2]]+R[n[e+3]]+"-"+R[n[e+4]]+R[n[e+5]]+"-"+R[n[e+6]]+R[n[e+7]]+"-"+R[n[e+8]]+R[n[e+9]]+"-"+R[n[e+10]]+R[n[e+11]]+R[n[e+12]]+R[n[e+13]]+R[n[e+14]]+R[n[e+15]]}const Oo=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),mt={randomUUID:Oo};function So(n,e,o){if(mt.randomUUID&&!e&&!n)return mt.randomUUID();n=n||{};const t=n.random||(n.rng||Po)();return t[6]=t[6]&15|64,t[8]=t[8]&63|128,xo(t)}const Mo="https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png",gt=new Pt,he=new C,de=new oe,yt=new C,bt=new oe,ne=new C,ke=m.createContext(null),Ao=m.forwardRef(({children:n,material:e=pn,texture:o=Mo,range:t,limit:s=200,frustumCulled:a,...f},r)=>{var l,d;const u=m.useMemo(()=>class extends e{constructor(){super();const A=parseInt(_t.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=k=>{k.vertexShader=`attribute float opacity;
               varying float vOpacity;
              `+k.vertexShader.replace("#include <fog_vertex>",`#include <fog_vertex>
                 vOpacity = opacity;
                `),k.fragmentShader=`varying float vOpacity;
              `+k.fragmentShader.replace(`#include <${A}>`,`#include <${A}>
                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);
                `)}}},[e]);sn({CloudMaterial:u});const h=m.useRef(null),b=m.useRef([]),x=m.useMemo(()=>new Float32Array(Array.from({length:s},()=>1)),[s]),P=m.useMemo(()=>new Float32Array(Array.from({length:s},()=>[1,1,1]).flat()),[s]),w=Ie(o);let M=0,T=0,v;const E=new oe,I=new C(0,0,1),O=new C;Et((A,k)=>{for(M=A.clock.getElapsedTime(),gt.copy(h.current.matrixWorld).invert(),A.camera.matrixWorld.decompose(yt,bt,ne),T=0;T<b.current.length;T++)v=b.current[T],v.ref.current.matrixWorld.decompose(he,de,ne),he.add(O.copy(v.position).applyQuaternion(de).multiply(ne)),de.copy(bt).multiply(E.setFromAxisAngle(I,v.rotation+=k*v.rotationFactor)),ne.multiplyScalar(v.volume+(1+Math.sin(M*v.density*v.speed))/2*v.growth),v.matrix.compose(he,de,ne).premultiply(gt),v.dist=he.distanceTo(yt);for(b.current.sort((_,X)=>X.dist-_.dist),T=0;T<b.current.length;T++)v=b.current[T],x[T]=v.opacity*(v.dist<v.fade-1?v.dist/v.fade:1),h.current.setMatrixAt(T,v.matrix),h.current.setColorAt(T,v.color);h.current.geometry.attributes.opacity.needsUpdate=!0,h.current.instanceMatrix.needsUpdate=!0,h.current.instanceColor&&(h.current.instanceColor.needsUpdate=!0)}),m.useLayoutEffect(()=>{const A=Math.min(s,t!==void 0?t:s,b.current.length);h.current.count=A,Se(h.current.instanceMatrix,{offset:0,count:A*16}),h.current.instanceColor&&Se(h.current.instanceColor,{offset:0,count:A*3}),Se(h.current.geometry.attributes.opacity,{offset:0,count:A})});let p=[(l=w.image.width)!==null&&l!==void 0?l:1,(d=w.image.height)!==null&&d!==void 0?d:1],U=Math.max(p[0],p[1]);return p=[p[0]/U,p[1]/U],m.createElement("group",W({ref:r},f),m.createElement(ke.Provider,{value:b},n,m.createElement("instancedMesh",{matrixAutoUpdate:!1,ref:h,args:[null,null,s],frustumCulled:a},m.createElement("instancedBufferAttribute",{usage:et,attach:"instanceColor",args:[P,3]}),m.createElement("planeGeometry",{args:[...p]},m.createElement("instancedBufferAttribute",{usage:et,attach:"attributes-opacity",args:[x,1]})),m.createElement("cloudMaterial",{key:e.name,map:w,transparent:!0,depthWrite:!1}))))}),vt=m.forwardRef(({opacity:n=1,speed:e=0,bounds:o=[5,1,1],segments:t=20,color:s="#ffffff",fade:a=10,volume:f=6,smallestVolume:r=.25,distribute:l=null,growth:d=4,concentrate:u="inside",seed:h=Math.random(),...b},x)=>{function P(){const E=Math.sin(h++)*1e4;return E-Math.floor(E)}const w=m.useContext(ke),M=m.useRef(null),[T]=m.useState(()=>So()),v=m.useMemo(()=>[...new Array(t)].map((E,I)=>({segments:t,bounds:new C(1,1,1),position:new C,uuid:T,index:I,ref:M,dist:0,matrix:new Pt,color:new mn,rotation:I*(Math.PI/t)})),[t,T]);return m.useLayoutEffect(()=>{v.forEach((E,I)=>{var O;rn(E,{volume:f,color:s,speed:e,growth:d,opacity:n,fade:a,bounds:o,density:Math.max(.5,P()),rotationFactor:Math.max(.2,.5*P())*e});const p=l==null?void 0:l(E,I);(p||t>1)&&E.position.copy(E.bounds).multiply((O=p==null?void 0:p.point)!==null&&O!==void 0?O:{x:P()*2-1,y:P()*2-1,z:P()*2-1});const U=Math.abs(E.position.x),A=Math.abs(E.position.y),k=Math.abs(E.position.z),_=Math.max(U,A,k);E.length=1,U===_&&(E.length-=U/E.bounds.x),A===_&&(E.length-=A/E.bounds.y),k===_&&(E.length-=k/E.bounds.z),E.volume=((p==null?void 0:p.volume)!==void 0?p.volume:Math.max(Math.max(0,r),u==="random"?P():u==="inside"?E.length:1-E.length))*f})},[u,o,a,s,n,d,f,h,t,e]),m.useLayoutEffect(()=>{const E=v;return w.current=[...w.current,...E],()=>{w.current=w.current.filter(I=>I.uuid!==T)}},[v]),m.useImperativeHandle(x,()=>M.current,[]),m.createElement("group",W({ref:M},b))}),Ho=m.forwardRef((n,e)=>m.useContext(ke)?m.createElement(vt,W({ref:e},n)):m.createElement(Ao,null,m.createElement(vt,W({ref:e},n))));export{Ao as C,Ro as K,Yo as O,Bo as P,Vo as S,W as _,co as a,Ko as b,Ie as c,Ho as d,jo as e,tt as f,zo as s,Lo as u};
